!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=54)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.SPRITE_SIZE=16,t.TILE_SIZE=8,t}();e.default=n},function(t,e,i){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.EAST=0]="EAST",t[t.SOUTH=1]="SOUTH",t[t.WEST=2]="WEST",t[t.NORTH=3]="NORTH"}(n=e.Direction||(e.Direction={}));var s={fromString:function(t){switch(void 0===t&&(t="SOUTH"),t.toUpperCase()){case"NORTH":return n.NORTH;case"EAST":return n.EAST;case"WEST":return n.WEST;case"SOUTH":default:return n.SOUTH}}};e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(27);e.AssetLoader=n.default;var s=i(26);e.AssetType=s.AssetType;var o=i(22);e.AudioSystem=o.default;var r=i(52);e.BitmapFont=r.default;var a=i(25);e.BrowserUtil=a.default;var h=i(51);e.CanvasResizer=h.default;var u=i(50);e.Delay=u.default;var c=i(49);e.FadeOutInState=c.default;var l=i(19);e.Game=l.default;var d=i(11);e.Image=d.default;var p=i(23);e.ImageAtlas=p.default;var f=i(5);e.ImageUtils=f.default;var _=i(18);e.InputManager=_.default;var g=i(10);e.Keys=g.Keys;var m=i(47);e.Point=m.default;var y=i(46);e.Pool=y.default;var v=i(45);e.Rectangle=v.default;var S=i(24);e.Sound=S.default;var E=i(12);e.SpriteSheet=E.default;var T=i(20);e.State=T.State;var b=i(21);e.StretchMode=b.StretchMode;var I=i(17);e.Timer=I.default;var w=i(3);e.Utils=w.default;var O=i(16);e.TiledLayer=O.default;var M=i(44);e.TiledMap=M.default;var P=i(15);e.TiledObject=P.default;var A=i(14);e.TiledTileset=A.default},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(25);e.default={getObjectSize:function(t){var e=0;for(var i in t)t.hasOwnProperty(i)&&e++;return e},getRequestParam:function(t){var e="&"+n.default.getWindowLocationSearch().substring(1),i="&"+t,s=e.indexOf(i);if(s>=-1){var o=s+i.length;if("="===e.charAt(o)){o++;var r=e.indexOf("&",o);return-1===r&&(r=e.length),e.substring(o,r)}if("&"===e.charAt(o))return"";if(o===e.length)return""}return null},hitch:function(t,e){return function(){e.apply(t,arguments)}},mixin:function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},randomInt:function(t,e){var i,n;return void 0===e?(i=0,n=t):(i=t,n=e),Math.floor(Math.random()*(n-i))+i},timestamp:function(){return window.performance&&window.performance.now?window.performance.now():Date.now()},initConsole:function(){if(!window.console){var t=function(){};window.console={info:t,log:t,warn:t,error:t}}}}},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s,o=i(9),r=i(2),a=i(1),h=i(0);!function(t){t[t.IN_BOX=0]="IN_BOX",t[t.LEAVING_BOX=1]="LEAVING_BOX",t[t.CHASING_PACMAN=2]="CHASING_PACMAN",t[t.SCATTERING=3]="SCATTERING",t[t.BLUE=4]="BLUE",t[t.EYES=5]="EYES",t[t.EYES_ENTERING_BOX=6]="EYES_ENTERING_BOX"}(s=e.MotionState||(e.MotionState={}));var u=function(t){function e(e,i,n){var s=t.call(this,2)||this;return s.game=e,s._corner=new r.Point,s._spriteSheetY=i,s._exitDelaySeconds=n,s.reset(),s}return n(e,t),e.prototype.changeDirectionFallback=function(t){var e=this.moveAmount;switch(r.Utils.randomInt(4)){case 0:this.goUpIfPossible(t,e)||this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||this.goDownIfPossible(t,e);break;case 1:this.goLeftIfPossible(t,e)||this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||this.goRightIfPossible(t,e);break;case 2:this.goDownIfPossible(t,e)||this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||this.goUpIfPossible(t,e);break;case 3:this.goRightIfPossible(t,e)||this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||this.goLeftIfPossible(t,e)}},e.prototype.continueInCurrentDirection=function(t){switch(this.direction){case a.Direction.NORTH:this.incY(-t);break;case a.Direction.WEST:this.incX(-t);break;case a.Direction.SOUTH:this.incY(t);break;case a.Direction.EAST:this.incX(t)}},e.prototype._getBlueTimeForLevel=function(t){switch(t){case 0:case 1:return 8e3;case 2:case 3:return 6e3;case 4:case 5:return 4e3;case 6:case 7:return 2e3;default:return 0}},e.prototype._getFirstExitDelayMillis=function(){return 1e3*this._exitDelaySeconds},e.prototype.getFrameCount=function(){return 2},Object.defineProperty(e.prototype,"motionState",{get:function(){return this._motionState},set:function(t){var e=this.game;if(t===s.SCATTERING)switch(this._scatterCount++){case 0:case 1:this._exitScatteringTime=e.playTime+7e3,this._motionState=t;break;case 2:case 3:this._exitScatteringTime=e.playTime+5e3,this._motionState=t;break;default:this._motionState=s.CHASING_PACMAN}else if(t===s.BLUE){var i=this._getBlueTimeForLevel(e.level),n=e.playTime;switch(this.exitBlueTime=n+i,this._motionState){case s.CHASING_PACMAN:this._previousState=this._motionState,this.startScatteringTime+=i;break;case s.SCATTERING:this._previousState=this._motionState,this._exitScatteringTime+=i;break;case s.BLUE:var o=this.exitBlueTime-n;switch(this._previousState){case s.CHASING_PACMAN:this.startScatteringTime+=o+i;break;case s.SCATTERING:this._exitScatteringTime+=o+i}break;default:throw new Error("Unexpected state: "+this._motionState)}this._motionState=t}else this._motionState===s.CHASING_PACMAN&&(this.startScatteringTime=e.playTime+2e4),this._motionState=t;this.game.checkLoopedSound()},enumerable:!0,configurable:!0}),e.prototype.getUpdateDelayMillis=function(){switch(this._motionState){case s.BLUE:return 25;case s.EYES:case s.EYES_ENTERING_BOX:default:return 10}},e.prototype.isBlue=function(){return this._motionState===s.BLUE},e.prototype.isEyes=function(){return this._motionState===s.EYES||this._motionState===s.EYES_ENTERING_BOX},e.prototype.paint=function(t){var e,i,n=this.bounds.x,o=this.bounds.y,r=h.default.SPRITE_SIZE;switch(this._motionState){case s.BLUE:e=(10+this.getFrame())*r,i=3*r;var a=game.playTime;this.exitBlueTime-a<=1e3&&0!=(a/250&1)&&(i+=r),game.drawSprite(n,o,e,i);break;case s.EYES:case s.EYES_ENTERING_BOX:e=this.direction*r,i=4*r,game.drawSprite(n,o,e,i);break;default:e=this.direction*r*this.getFrameCount()+this.getFrame()*r,i=this._spriteSheetY,game.drawSprite(n,o,e,i)}},e.prototype.possiblyTurnBlue=function(){switch(this._motionState){case s.CHASING_PACMAN:case s.SCATTERING:case s.BLUE:return this.motionState=s.BLUE,!0;default:return!1}},e.prototype.reset=function(){t.prototype.reset.call(this),this._scatterCount=0},e.prototype.setCorner=function(t){this._corner.x=t.x,this._corner.y=t.y},e.prototype._updatePositionBlue=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=game.pacman,n=i.row,s=i.column,o=this.row,r=this.column,h=!1;o===n&&t.isClearShotRow(o,r,s)?(this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||(s<r?this.goRightIfPossible(t,e)||(this.direction=a.Direction.WEST,this.incX(-e)):this.goLeftIfPossible(t,e)||(this.direction=a.Direction.EAST,this.incX(e))),h=!0):r===s&&t.isClearShotColumn(r,o,n)&&(this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||(n<o?this.goDownIfPossible(t,e)||(this.direction=a.Direction.NORTH,this.incY(-e)):this.goUpIfPossible(t,e)||(this.direction=a.Direction.SOUTH,this.incY(e))),h=!0),h||this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.exitBlueTime&&(this.motionState=this._previousState)},e.prototype._updatePositionEyes=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,n=this.column,o=Math.floor((game.PENALTY_BOX_EXIT_Y+8)/h.default.TILE_SIZE),r=Math.floor(game.PENALTY_BOX_EXIT_X/h.default.TILE_SIZE);n<=r&&r++;var u=t.getPathBreadthFirst(i,n,o,r);null==u?this.motionState=s.EYES_ENTERING_BOX:u.col<n?(this.direction=a.Direction.WEST,this.incX(-e)):u.col>n?(this.direction=a.Direction.EAST,this.incX(e)):u.row<i?(this.direction=a.Direction.NORTH,this.incY(-e)):u.row>i&&(this.direction=a.Direction.SOUTH,this.incY(e))}else{(i=this.row)===(o=Math.floor((game.PENALTY_BOX_EXIT_Y+8)/h.default.TILE_SIZE))&&this.x===game.PENALTY_BOX_EXIT_X?this.motionState=s.EYES_ENTERING_BOX:this.continueInCurrentDirection(e)}},e.prototype._updatePositionEyesEnteringBox=function(t){this.y<game.PENALTY_BOX_EXIT_Y+3*h.default.SPRITE_SIZE/2?(this.direction=a.Direction.SOUTH,this.incY(.5)):this.motionState=s.LEAVING_BOX},e.prototype.updatePositionImpl=function(t){switch(this._motionState){case s.IN_BOX:this.updatePositionInBox(t);break;case s.LEAVING_BOX:this.updatePositionLeavingBox(t);break;case s.SCATTERING:this.updatePositionScattering(t);break;case s.CHASING_PACMAN:this.updatePositionChasingPacman(t);break;case s.BLUE:this._updatePositionBlue(t);break;case s.EYES:this._updatePositionEyes(t);break;case s.EYES_ENTERING_BOX:this._updatePositionEyesEnteringBox(t)}},e.prototype.updatePositionInBox=function(t){switch(this.direction){case a.Direction.WEST:case a.Direction.NORTH:this.y>112?this.incY(-.5):this.direction=a.Direction.SOUTH;break;case a.Direction.EAST:case a.Direction.SOUTH:this.y<120?this.incY(.5):this.direction=a.Direction.NORTH}game.playTime>=this._getFirstExitDelayMillis()&&(this.motionState=s.LEAVING_BOX)},e.prototype.updatePositionLeavingBox=function(t){var e=this.x;if(e<game.PENALTY_BOX_EXIT_X)this.direction=a.Direction.EAST,this.incX(.5);else if(e>game.PENALTY_BOX_EXIT_X)this.direction=a.Direction.WEST,this.incX(-.5);else{var i=this.y-.5;this.y=i,i<=game.PENALTY_BOX_EXIT_Y?(i=game.PENALTY_BOX_EXIT_Y,this.motionState=s.SCATTERING,this.direction=a.Direction.WEST):this.direction=a.Direction.NORTH}},e.prototype.updatePositionScattering=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,n=this.column,o=this._corner.x,r=this._corner.y,h=t.getPathBreadthFirst(i,n,o,r);h?h.col<n?(this.direction=a.Direction.WEST,this.incX(-e)):h.col>n?(this.direction=a.Direction.EAST,this.incX(e)):h.row<i?(this.direction=a.Direction.NORTH,this.incY(-e)):h.row>i&&(this.direction=a.Direction.SOUTH,this.incY(e)):this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this._exitScatteringTime&&(this.motionState=s.CHASING_PACMAN)},e}(o._BaseSprite);e.Ghost=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={allowSubpixelImageRendering:!1,resize:function(t,e){var i,s;if(void 0===e&&(e=1),t instanceof HTMLImageElement?(s=(i=n.createCanvas(t.width,t.height)).getContext("2d")).drawImage(t,0,0):s=(i=t).getContext("2d"),1===e)return i;for(var o=s.getImageData(0,0,t.width,t.height),r=t.width*e,a=t.height*e,h=n.createCanvas(r,a),u=h.getContext("2d"),c=u.getImageData(0,0,r,a),l=0;l<a;l++)for(var d=0;d<r;d++){var p=4*(Math.floor(l/e)*t.width+Math.floor(d/e)),f=4*(l*r+d);c.data[f]=o.data[p],c.data[f+1]=o.data[p+1],c.data[f+2]=o.data[p+2],c.data[f+3]=o.data[p+3]}return u.putImageData(c,0,0),h},createCanvas:function(t,e,i){var s=document.createElement("canvas");if(s.width=t,s.height=e,n.prepCanvas(s),i){var o="string"==typeof i?document.getElementById(i):i;o.innerHTML="",o.appendChild(s)}return s},prepCanvas:function(t){var e=t.getContext("2d");e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.oImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1},makeColorTranslucent:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=t.getContext("2d"),s=t.width,o=t.height,r=n.getImageData(0,0,s,o),a=[],h=4*(i*s+e),u=0;u<4;u++)a[u]=r.data[h+u];for(i=0;i<o;i++)for(e=0;e<s;e++){var c=4*(i*s+e);r.data[c]===a[0]&&r.data[c+1]===a[1]&&r.data[c+2]===a[2]&&r.data[c+3]===a[3]&&(r.data[c]=0,r.data[c+1]=0,r.data[c+2]=0,r.data[c+3]=0)}return n.putImageData(r,0,0),t}};e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={CHASING_GHOSTS:"chasingGhosts",CHOMP_1:"chomp1",CHOMP_2:"chomp2",DIES:"dies",EATING_FRUIT:"eatingFruit",EATING_GHOST:"eatingGhost",EXTRA_LIFE:"extraLife",INTERMISSION:"intermission",EYES_RUNNING:"eyesRunning",OPENING:"opening",SIREN:"siren",TOKEN:"token"}},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(2),o=function(t){function e(e){var i=t.call(this,e)||this;return i._lastConfigKeypressTime=s.Utils.timestamp(),i._lastSpriteFrameTime=0,i}return n(e,t),Object.defineProperty(e,"INPUT_REPEAT_MILLIS",{get:function(){return 200},enumerable:!0,configurable:!0}),e.prototype.handleDefaultKeys=function(){var t=s.Utils.timestamp(),i=this.game.inputManager;if(t>this._lastConfigKeypressTime+e.INPUT_REPEAT_MILLIS&&(i.isKeyDown(s.Keys.KEY_M,!0)&&(game.toggleMuted(),this._lastConfigKeypressTime=t),i.isKeyDown(s.Keys.KEY_Z)))if(i.isKeyDown(s.Keys.KEY_P,!0))(n=game.canvas.style).width||(n.width=game.canvas.width+"px"),n.height||(n.height=game.canvas.height+"px"),n.width=parseInt(n.width.substring(0,n.width.length-2),10)+1+"px",n.height=parseInt(n.height.substring(0,n.height.length-2),10)+1+"px",game.setStatusMessage("Canvas size now: ("+n.width+", "+n.height+")"),this._lastConfigKeypressTime=t;else if(i.isKeyDown(s.Keys.KEY_L,!0)){var n;(n=game.canvas.style).width||(n.width=game.canvas.width+"px"),n.height||(n.height=game.canvas.height+"px"),n.width=parseInt(n.width.substring(0,n.width.length-2),10)-1+"px",n.height=parseInt(n.height.substring(0,n.height.length-2),10)-1+"px",game.setStatusMessage("Canvas size now: ("+n.width+", "+n.height+")"),this._lastConfigKeypressTime=t}else i.isKeyDown(s.Keys.KEY_G,!0)?(game.toggleGodMode(),this._lastConfigKeypressTime=t):i.isKeyDown(s.Keys.KEY_S,!0)&&game.toggleStretchMode()},e.prototype._updateSpriteFrames=function(){var t=game.playTime;t>=this._lastSpriteFrameTime+100&&(this._lastSpriteFrameTime=t,game.updateSpriteFrames())},e}(s.State);e._BaseState=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),s=i(42),o=i(0),r=[50,10],a=function(){function t(t){this.closed=[],this.open=[],this.goalNode=new s.MazeNode,this._data=[],this.reset(t)}return t._cloneObjectOfPrimitives=function(t){return JSON.parse(JSON.stringify(t))},t.prototype.checkForDot=function(e,i){var n=0,s=this._getTileAt(e,i);return s>=254&&(game.playChompSound(),254===s&&game.makeGhostsBlue(),this._eatenDotCount++,this._data[e][i]=0,n=r[s-254],this._eatenDotCount===t.FRUIT_DOT_COUNT&&game.addFruit(),this._eatenDotCount===this._dotCount&&game.loadNextLevel()),n},t._constructPath=function(t){for(var e=null;t.parent;)e=t,t=t.parent;return e},Object.defineProperty(t,"FRUIT_DOT_COUNT",{get:function(){return 64},enumerable:!0,configurable:!0}),t._getNextColumn=function(e){return++e===t.TILE_COUNT_HORIZONTAL&&(e=0),e},t.prototype.getPathBreadthFirst=function(e,i,n,o){var r=this;this.open.forEach(function(t){r._data[t.row][t.col]&=255}),this.closed.forEach(function(t){r._data[t.row][t.col]&=255}),this.open.length=0,this.closed.length=0,this.goalNode.set(n,o,null);var a=this._nodeCache.borrowObj();for(this.open.push(new s.MazeNode(e,i)),this._data[e][i]|=256;this.open.length>0;){var h=this.open.splice(0,1)[0];if(h.equals(this.goalNode))return this._data[h.row][h.col]&=255,t._constructPath(h);this.closed.push(h),this.isWalkable(h.row-1,h.col)&&0==(256&this._data[h.row-1][h.col])&&(this._data[h.row-1][h.col]|=256,a.set(h.row-1,h.col,h),this.open.push(a),a=this._nodeCache.borrowObj()),this.isWalkable(h.row+1,h.col)&&0==(256&this._data[h.row+1][h.col])&&(this._data[h.row+1][h.col]|=256,a.set(h.row+1,h.col,h),this.open.push(a),a=this._nodeCache.borrowObj());var u=t._getPreviousColumn(h.col);this.isWalkable(h.row,u)&&0==(256&this._data[h.row][u])&&(this._data[h.row][u]|=256,a.set(h.row,u,h),this.open.push(a),a=this._nodeCache.borrowObj()),u=t._getNextColumn(h.col),this.isWalkable(h.row,u)&&0==(256&this._data[h.row][u])&&(this._data[h.row][u]|=256,a.set(h.row,u,h),this.open.push(a),a=this._nodeCache.borrowObj())}throw new Error("No path found from ("+e+", "+i+") to ("+n+", "+o+")")},t._getPreviousColumn=function(e){return 0===e&&(e=t.TILE_COUNT_HORIZONTAL),e-1},Object.defineProperty(t,"TILE_COUNT_HORIZONTAL",{get:function(){return 28},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TILE_COUNT_VERTICAL",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TILE_DOT_BIG",{get:function(){return 254},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TILE_DOT_SMALL",{get:function(){return 255},enumerable:!0,configurable:!0}),t.prototype._getTileAt=function(e,i){return i<0||i>=t.TILE_COUNT_HORIZONTAL?-1:e<0||e>=t.TILE_COUNT_VERTICAL?-1:255&this._data[e][i]},t.prototype.isClearShotColumn=function(t,e,i){for(var n=Math.min(e,i),s=Math.max(e,i),o=n+1;o<s;o++)if(!this.isWalkable(o,t))return!1;return!0},t.prototype.isClearShotRow=function(t,e,i){for(var n=Math.min(e,i),s=Math.max(e,i),o=n+1;o<s;o++)if(!this.isWalkable(t,o))return!1;return!0},t.prototype.isWalkable=function(t,e){var i=this._getTileAt(t,e);return 0===i||i>=240},t.prototype.render=function(e){e.drawImage(this._mazeCanvas,0,0);e.fillStyle="#ffffff";for(var i=0;i<t.TILE_COUNT_VERTICAL;i++)for(var n=8*i+16,s=0;s<t.TILE_COUNT_HORIZONTAL;s++){var o=this._getTileAt(i,s),r=8*s;o===t.TILE_DOT_SMALL?game.drawSmallDot(r+3,n+2):o===t.TILE_DOT_BIG&&game.drawBigDot(r,n)}},t.prototype.reset=function(e){var i=o.default.TILE_SIZE,r=null!=e;if(r&&(this._origMazeInfo=t._cloneObjectOfPrimitives(e)),this._data=t._cloneObjectOfPrimitives(this._origMazeInfo),this._eatenDotCount=0,r){var a=game.assets.get("mapTiles"),h=2*i;this._mazeCanvas=n.ImageUtils.createCanvas(game.getWidth(),game.getHeight());var u=this._mazeCanvas.getContext("2d"),c=0;this._dotCount=0,u.fillStyle="#000000",u.fillRect(0,0,this._mazeCanvas.width,this._mazeCanvas.height),game.drawScoresHeaders(u);for(var l=0;l<this._data.length;l++)for(var d=this._data[l],p=0;p<d.length;p++){var f=d[p];switch((0===f||f>=240)&&c++,f){case t.TILE_DOT_SMALL:case t.TILE_DOT_BIG:this._dotCount++;break;default:if(--f>-1){var _=p*i,g=h+l*i;a.drawByIndex(u,_,g,f)}}}this._nodeCache||(this._nodeCache=new n.Pool(s.MazeNode,c))}},t}();e.Maze=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),s=i(1),o=i(8),r=i(0),a=function(){function t(t){this.bounds=new n.Rectangle(0,0,r.default.SPRITE_SIZE,r.default.SPRITE_SIZE),this._intersectBounds=new n.Rectangle,this.direction=s.Direction.EAST,this._frame=0,this._frameCount=t,this._lastUpdateTime=0}return t.prototype.atIntersection=function(t){switch(this.direction){case s.Direction.NORTH:case s.Direction.SOUTH:return this.getCanMoveLeft(t)||this.getCanMoveRight(t);case s.Direction.EAST:case s.Direction.WEST:return this.getCanMoveUp(t)||this.getCanMoveDown(t)}return!1},t.prototype.getCanMoveDown=function(t){var e=this.centerX,i=this.centerY,n=e%this.TILE_SIZE,o=i%this.TILE_SIZE;if(0===n&&0===o){var r=this.row,a=this.column;return r<30&&t.isWalkable(r+1,a)}return this.direction===s.Direction.NORTH||this.direction===s.Direction.SOUTH},t.prototype.getCanMoveLeft=function(t){var e=this.bounds.x;if(e<0)return!0;e+=this.TILE_SIZE/2;var i=this.centerY,n=e%this.TILE_SIZE,o=i%this.TILE_SIZE;if(0===n&&0===o){var r=this.row,a=this.column;return a>0&&t.isWalkable(r,a-1)}return this.direction===s.Direction.EAST||this.direction===s.Direction.WEST},t.prototype.getCanMoveRight=function(t){var e=this.bounds.x;if(e+this.width>this.SCREEN_WIDTH)return!0;e+=this.TILE_SIZE/2;var i=this.centerY,n=e%this.TILE_SIZE,o=i%this.TILE_SIZE;if(0===n&&0===o){var r=this.row,a=this.column;return a<27&&t.isWalkable(r,a+1)}return this.direction===s.Direction.EAST||this.direction===s.Direction.WEST},t.prototype.getCanMoveUp=function(t){var e=this.centerX,i=this.centerY;e%1==0&&i%1==0||console.error("Unexpected condition: x === "+e+", y === "+i);var n=e%this.TILE_SIZE,o=i%this.TILE_SIZE;if(0===n&&0===o){var r=this.row,a=this.column;return r>0&&t.isWalkable(r-1,a)}return this.direction===s.Direction.NORTH||this.direction===s.Direction.SOUTH},Object.defineProperty(t.prototype,"centerX",{get:function(){return this.bounds.x+this.TILE_SIZE/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"centerY",{get:function(){return this.bounds.y+this.TILE_SIZE/2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){var t=Math.floor(this.centerX/this.TILE_SIZE);return t<0?t+=o.Maze.TILE_COUNT_HORIZONTAL:t>=o.Maze.TILE_COUNT_HORIZONTAL&&(t-=o.Maze.TILE_COUNT_HORIZONTAL),t},enumerable:!0,configurable:!0}),t.prototype.getFrame=function(){return this._frame},t.prototype.getFrameCount=function(){return this._frameCount},Object.defineProperty(t.prototype,"intersectBounds",{get:function(){return this._intersectBounds.set(this.bounds.x+2,this.bounds.y-2,this.bounds.w-4,this.bounds.h-4),this._intersectBounds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moveAmount",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TILE_SIZE",{get:function(){return 8},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.bounds.w},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return Math.floor(this.centerY/this.TILE_SIZE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.bounds.x},set:function(t){this.bounds.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.bounds.y},set:function(t){this.bounds.y=t},enumerable:!0,configurable:!0}),t.prototype.goDownIfPossible=function(t,e){return!!this.getCanMoveDown(t)&&(this.direction=s.Direction.SOUTH,this.incY(e),!0)},t.prototype.goLeftIfPossible=function(t,e){return!!this.getCanMoveLeft(t)&&(this.direction=s.Direction.WEST,this.incX(-e),!0)},t.prototype.goRightIfPossible=function(t,e){return!!this.getCanMoveRight(t)&&(this.direction=s.Direction.EAST,this.incX(e),!0)},t.prototype.goUpIfPossible=function(t,e){return!!this.getCanMoveUp(t)&&(this.direction=s.Direction.NORTH,this.incY(-e),!0)},t.prototype.incX=function(t){this.bounds.x+=t,this.bounds.x+this.width<=0?this.bounds.x+=this.SCREEN_WIDTH:this.bounds.x>=this.SCREEN_WIDTH&&(this.bounds.x-=this.SCREEN_WIDTH)},t.prototype.incY=function(t){this.bounds.y+=t},t.prototype.intersects=function(t){return this.intersectBounds.intersects(t.intersectBounds)},t.prototype.reset=function(){this._lastUpdateTime=0},Object.defineProperty(t.prototype,"SCREEN_WIDTH",{get:function(){return 224},enumerable:!0,configurable:!0}),t.prototype.setLocation=function(t,e){this.bounds.x=t,this.bounds.y=e},t.prototype.updateFrame=function(){this._frame=(this._frame+1)%this.getFrameCount()},t.prototype.updatePosition=function(t,e){e>this._lastUpdateTime+this.getUpdateDelayMillis()&&(this._lastUpdateTime=e,this.updatePositionImpl(t))},t}();e._BaseSprite=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.KEY_ENTER=13]="KEY_ENTER",t[t.KEY_SHIFT=16]="KEY_SHIFT",t[t.KEY_CTRL=17]="KEY_CTRL",t[t.KEY_SPACE=32]="KEY_SPACE",t[t.KEY_LEFT_ARROW=37]="KEY_LEFT_ARROW",t[t.KEY_UP_ARROW=38]="KEY_UP_ARROW",t[t.KEY_RIGHT_ARROW=39]="KEY_RIGHT_ARROW",t[t.KEY_DOWN_ARROW=40]="KEY_DOWN_ARROW",t[t.KEY_0=48]="KEY_0",t[t.KEY_1=49]="KEY_1",t[t.KEY_2=50]="KEY_2",t[t.KEY_3=51]="KEY_3",t[t.KEY_4=52]="KEY_4",t[t.KEY_5=53]="KEY_5",t[t.KEY_6=54]="KEY_6",t[t.KEY_7=55]="KEY_7",t[t.KEY_8=56]="KEY_8",t[t.KEY_9=57]="KEY_9",t[t.KEY_A=65]="KEY_A",t[t.KEY_B=66]="KEY_B",t[t.KEY_C=67]="KEY_C",t[t.KEY_D=68]="KEY_D",t[t.KEY_E=69]="KEY_E",t[t.KEY_F=70]="KEY_F",t[t.KEY_G=71]="KEY_G",t[t.KEY_H=72]="KEY_H",t[t.KEY_I=73]="KEY_I",t[t.KEY_J=74]="KEY_J",t[t.KEY_K=75]="KEY_K",t[t.KEY_L=76]="KEY_L",t[t.KEY_M=77]="KEY_M",t[t.KEY_N=78]="KEY_N",t[t.KEY_O=79]="KEY_O",t[t.KEY_P=80]="KEY_P",t[t.KEY_Q=81]="KEY_Q",t[t.KEY_R=82]="KEY_R",t[t.KEY_S=83]="KEY_S",t[t.KEY_T=84]="KEY_T",t[t.KEY_U=85]="KEY_U",t[t.KEY_V=86]="KEY_V",t[t.KEY_W=87]="KEY_W",t[t.KEY_X=88]="KEY_X",t[t.KEY_Y=89]="KEY_Y",t[t.KEY_Z=90]="KEY_Z"}(e.Keys||(e.Keys={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=function(){function t(t,e,i,n,s){this._canvas=t,void 0!==e&&void 0!==i&&void 0!==n&&void 0!==s?(this.x=e,this.y=i,this._width=n,this._height=s):(this.x=this.y=0,this._width=this._canvas.width,this._height=this._canvas.height),this._ensure256Square()}return t.prototype._ensure256Square=function(){if(this._canvas.width<256||this._canvas.height<256){var t=Math.max(256,this._canvas.width),e=Math.max(256,this._canvas.height),i=n.default.createCanvas(t,e);i.getContext("2d").drawImage(this._canvas,0,0),this._canvas=i}},t.prototype.draw=function(t,e,i){n.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i)),t.drawImage(this._canvas,this.x,this.y,this._width,this._height,e,i,this._width,this._height)},t.prototype.drawScaled=function(t,e,i,s,o){n.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i)),t.drawImage(this._canvas,this.x,this.y,this._width,this._height,e,i,s,o)},t.prototype.drawScaled2=function(t,e,i,s,o,r,a,h,u){n.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i),r=Math.round(r),a=Math.round(a)),e=this.x+e,i=this.y+i,t.drawImage(this._canvas,e,i,s,o,r,a,h,u)},t.prototype.makeColorTranslucent=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),n.default.makeColorTranslucent(this._canvas,t,e)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t}();e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n,s){void 0===n&&(n=1),void 0===s&&(s=n),this.gtpImage=t,this.cellW=e,this.cellH=i,this.spacingX=n,this.spacingY=s,this.rowCount=Math.floor(t.height/(i+this.spacingY)),t.height-this.rowCount*(i+this.spacingY)>=i&&this.rowCount++,this.colCount=Math.floor(t.width/(e+this.spacingX)),t.width-this.colCount*(e+this.spacingX)>=e&&this.colCount++,this.size=this.rowCount*this.colCount}return t.prototype.drawSprite=function(t,e,i,n,s){var o=this.cellW,r=this.cellH,a=(o+this.spacingX)*s,h=(r+this.spacingY)*n;this.gtpImage.drawScaled2(t,a,h,o,r,e,i,o,r)},t.prototype.drawByIndex=function(t,e,i,n){var s=Math.floor(n/this.colCount),o=Math.floor(n%this.colCount);this.drawSprite(t,e,i,s,o)},t}();e.default=n},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(7),o=i(1),r=i(6),a=i(0),h=function(t){function e(e){var i=t.call(this,e)||this;return i._initSprites(),i.handleStart=i.handleStart.bind(i),i}return n(e,t),e.prototype.enter=function(){t.prototype.enter.call(this,game),game.canvas.addEventListener("touchstart",this.handleStart,!1),this._choice=0,this._lastKeypressTime=game.playTime,this._initSprites()},e.prototype._initSprites=function(){var t=game.pacman;t.setLocation(game.getWidth()/2,240),t.direction=o.Direction.EAST;var e=game.getGhost(0);e.setLocation(game.getWidth()/2-3*a.default.SPRITE_SIZE,240),e.direction=o.Direction.EAST},e.prototype.leaving=function(t){t.canvas.removeEventListener("touchstart",this.handleStart,!1)},e.prototype.getGame=function(){return this.game},e.prototype.handleStart=function(){this._startGame()},e.prototype.render=function(t){var e=game.getWidth(),i=game.getHeight();this._renderStaticStuff(t);var n=(e-135)/2-5,s=(i-30)/2;this.getGame().drawString(n,s+15*this._choice,">"),n+=13.5,s=200,game.canvas.getContext("2d").fillStyle="#ffffff",game.drawSmallDot(n+3,s+2),s+=9,game.drawBigDot(n,s),game.pacman.render(t),game.getGhost(0).paint(t),game.audio.isInitialized()||this._renderNoSoundMessage()},e.prototype._stringWidth=function(t){return game.assets.get("font").cellW*t.length},e.prototype._renderNoSoundMessage=function(){var t=game.getWidth(),e="SOUND IS DISABLED AS",i=(t-this._stringWidth(e))/2,n=game.getHeight()-20-27;this.getGame().drawString(i,n,e),e="YOUR BROWSER DOES NOT",i=(t-this._stringWidth(e))/2,n+=9,this.getGame().drawString(i,n,e),e="SUPPORT WEB AUDIO",i=(t-this._stringWidth(e))/2,n+=9,this.getGame().drawString(i,n,e)},e.prototype._renderStaticStuff=function(t){var e=this.game;e.clearScreen("rgb(0,0,0)");var i=e.getWidth();e.drawScores(t),e.drawScoresHeaders(t);var n=e.assets.get("title"),s=(i-n.width)/2,o=1.2*n.height;n.draw(t,s,o);var r="STANDARD MAZE",a=r.length-1;s=(i-9*a)/2-5,o=(e.getHeight()-30)/2,this.getGame().drawString(s,o,r,t),r="ALTERNATE MAZE",o+=15,this.getGame().drawString(s,o,r,t),s+=18,a=(r="10 POINTS").length-2,o=200,this.getGame().drawString(s,o,r,t),r="50 POINTS",o+=9,this.getGame().drawString(s,o,r,t),s=(i-9*(r="2015 OLD MAN GAMES").length)/2,o=e.getHeight()-20,this.getGame().drawString(s,o,r,t)},e.prototype._startGame=function(){game.startGame(this._choice)},e.prototype.update=function(t){this.handleDefaultKeys();var e=game.playTime;if(e>this._lastKeypressTime+s._BaseState.INPUT_REPEAT_MILLIS+100){var i=game.inputManager;i.up()?(this._choice=Math.abs(this._choice-1),game.audio.playSound(r.default.TOKEN),this._lastKeypressTime=e):i.down()?(this._choice=(this._choice+1)%2,game.audio.playSound(r.default.TOKEN),this._lastKeypressTime=e):i.enter(!0)&&this._startGame()}var n=game.pacman,a=game.getGhost(0),h=n.moveAmount;n.direction===o.Direction.WEST&&(h=-h),n.incX(h),h=a.moveAmount,a.direction===o.Direction.WEST&&(h=-h),a.incX(h),n.x+n.width>=this.game.getWidth()-30?n.direction=a.direction=o.Direction.WEST:a.x<=30&&(n.direction=a.direction=o.Direction.EAST),this._updateSpriteFrames()},e}(s._BaseState);e.TitleState=h},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.firstgid=t.firstgid,this.image=t.image,e&&(this.image=e(this.image)),this.imageWidth=t.imagewidth,this.imageHeight=t.imageheight,this.margin=t.margin,this.name=t.name,this.properties=t.properties,this.spacing=t.spacing,this.tileWidth=t.tilewidth,this.tileHeight=t.tileheight}return t.prototype.setScale=function(t){this.imageWidth*=t,this.imageHeight*=t,this.tileWidth*=t,this.tileHeight*=t,this.margin*=t,this.spacing*=t},t}();e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),s=function(){function t(t){n.default.mixin(t,this),this.properties=this.properties||{},this.gid=this.gid||-1;var e=window.game;this.x*=e._scale,this.y*=e._scale,this.width*=e._scale,this.height*=e._scale}return t.prototype.intersects=function(t,e,i,n){var s=this.width,o=this.height,r=i,a=n;if(r<=0||a<=0||s<=0||o<=0)return!1;var h=this.x,u=this.y;return a+=e,s+=h,o+=u,((r+=t)<t||r>h)&&(a<e||a>u)&&(s<h||s>t)&&(o<u||o>e)},t}();e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(15),s=function(){function t(t,e){this.map=t,this.name=e.name,this.width=e.width,this.height=e.height,this.data=e.data,this.opacity=e.opacity,this.visible=e.visible,this.type=e.type,this.x=e.x,this.y=e.y,this._setObjects(e.objects)}return t.prototype.getData=function(t,e){if(!this.data)return-1;var i=this._getIndex(t,e);return this.data[i]},t.prototype.setData=function(t,e,i){if(!this.data)return!1;var n=this._getIndex(t,e);return this.data[n]=i,!0},t.prototype._getIndex=function(t,e){return t*this.map.colCount+e},t.prototype.getObjectByName=function(t){return this.objectsByName?this.objectsByName[t]:null},t.prototype.getObjectIntersecting=function(t,e,i,n){if(this.objects)for(var s=0;s<this.objects.length;s++){var o=this.objects[s];if(o.intersects(t,e,i,n))return o}return null},t.prototype.isObjectGroup=function(){return"objectgroup"===this.type},t.prototype._setObjects=function(t){if(t){this.objects=[],this.objectsByName={};for(var e=0;e<t.length;e++){var i=new n.default(t[e]);this.objects.push(i),this.objectsByName[t[e].name]=i}}},t}();e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),s=function(){function t(){this._startTimes={},this._prefix="DEBUG"}return t.prototype.setLogPrefix=function(t){void 0===t&&(t="DEBUG"),this._prefix=t},t.prototype.start=function(t){this._startTimes[t]=n.default.timestamp()},t.prototype.end=function(t){var e=this._startTimes[t];if(!e)return console.error('Cannot end timer for "'+t+'" as it was never started'),-1;var i=n.default.timestamp()-e;return delete this._startTimes[t],i},t.prototype.endAndLog=function(t){var e=this.end(t);e>-1&&console.log(this._prefix+": "+t+": "+e+" ms")},t}();e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(10),s=function(){function t(t){void 0===t&&(t=0),this.keys=[],this._refireMillis=t,this._repeatTimers=[]}return t.prototype.clearKeyState=function(t){this.keys[t]=!1,this._repeatTimers[t]&&(clearInterval(this._repeatTimers[t]),this._repeatTimers[t]=null)},t.prototype.clearKeyStates=function(){for(var t=0;t<this.keys.length;t++)this.clearKeyState(t)},t.prototype.ctrl=function(t){return void 0===t&&(t=!1),this.isKeyDown(n.Keys.KEY_CTRL,t)},t.prototype.down=function(t){return void 0===t&&(t=!1),this.isKeyDown(n.Keys.KEY_DOWN_ARROW,t)},t.prototype.enter=function(t){return void 0===t&&(t=!1),this.isKeyDown(n.Keys.KEY_ENTER,t)},t.prototype.install=function(){var t=this;document.onkeydown=function(e){t._keyDown(e)},document.onkeyup=function(e){t._keyUp(e)}},t.prototype.isKeyDown=function(t,e){void 0===e&&(e=!1);var i=this.keys[t];return i&&e&&(this.keys[t]=!1),i},t.prototype._keyDown=function(t){var e=this,i=t.keyCode;(32===i||i>=37&&i<=40)&&t.preventDefault(),this._refireMillis?this._repeatTimers[i]||(this.keys[i]=!0,this._repeatTimers[i]=setInterval(function(){e.keys[i]=!0},this._refireMillis)):this.keys[i]=!0,t.stopPropagation()},t.prototype._keyUp=function(t){var e=t.keyCode;this._refireMillis?this._repeatTimers[e]?(this.keys[e]=!1,clearInterval(this._repeatTimers[e]),this._repeatTimers[e]=null):console.error("_keyUp: Timer does not exist for key: "+e+"!"):this.keys[e]=!1,t.stopPropagation()},t.prototype.left=function(t){return void 0===t&&(t=!1),this.isKeyDown(n.Keys.KEY_LEFT_ARROW,t)},t.prototype.right=function(t){return void 0===t&&(t=!1),this.isKeyDown(n.Keys.KEY_RIGHT_ARROW,t)},t.prototype.shift=function(t){return void 0===t&&(t=!1),this.isKeyDown(n.Keys.KEY_SHIFT,t)},t.prototype.up=function(t){return void 0===t&&(t=!1),this.isKeyDown(n.Keys.KEY_UP_ARROW,t)},t}();e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(10),s=i(18),o=i(48),r=i(17),a=i(5),h=i(3),u=i(22),c=i(27),l=1e3,d=30,p=function(){function t(t){void 0===t&&(t={}),h.default.initConsole(),this._scale=t.scale||1,this.canvas=a.default.createCanvas(t.width,t.height,t.parent),this.inputManager=new s.default(t.keyRefreshMillis||0),this.inputManager.install(),this._targetFps=t.targetFps||d,this._interval=l/this._targetFps,this.lastTime=0,this.audio=new u.default,this.audio.init();var e=t.assetRoot||null;this.assets=new c.default(this._scale,this.audio,e),this.clearScreenColor="rgb(0,0,0)",this.fpsColor="rgb(255,255,255)",this.statusMessageRGB="255,255,255",this._statusMessageColor=null,this.showFps=!1,this.frames=0,this._fpsMsg=this._targetFps+" fps",this._statusMessage=null,this._statusMessageAlpha=0,this._statusMessageTime=0,this._gameTimer=new o._GameTimer,this.timer=new r.default}return t.prototype.clearScreen=function(t){void 0===t&&(t=this.clearScreenColor);var e=this.canvas.getContext("2d");e.fillStyle=t,e.fillRect(0,0,this.getWidth(),this.getHeight())},t.prototype.getHeight=function(){return this.canvas.height},t.prototype.getWidth=function(){return this.canvas.width},Object.defineProperty(t.prototype,"paused",{get:function(){return this._gameTimer.paused},set:function(t){t?this.audio.pauseAll():this.audio.resumeAll(),this._gameTimer.paused=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playTime",{get:function(){return this._gameTimer.playTime},enumerable:!0,configurable:!0}),t.prototype.randomInt=function(t){return Math.floor(Math.random()*(t-0+1)+0)},t.prototype.render=function(){var t=this.canvas.getContext("2d");this.state.render(t),this.showFps&&this._renderFps(t),this._statusMessage&&this._statusMessageAlpha>0&&this._renderStatusMessage(t)},t.prototype._renderFps=function(t){this.frames++;var e=h.default.timestamp();e-this.lastTime>=l&&(this._fpsMsg=this.frames+" fps",this.frames=0,this.lastTime=e);t.font="10pt Arial",t.fillStyle=this.fpsColor,t.fillText(this._fpsMsg,10,15)},t.prototype._renderStatusMessage=function(t){if(this._statusMessage){var e=this.canvas.height-6;t.font="10pt Arial",t.fillStyle=this._statusMessageColor||"#fff",t.fillText(this._statusMessage,10,e)}},t.prototype.resetPlayTime=function(){this._gameTimer.resetPlayTime()},t.prototype.setState=function(t){this.state&&this.state.leaving(this),this.state=t,this.state.enter(this)},t.prototype.setStatusMessage=function(t){this._statusMessage=t,this._statusMessageAlpha=2,this._statusMessageTime=h.default.timestamp()+100},t.prototype.start=function(){var t=h.default.hitch(this,this._tick);this._gameTimer.start(),setInterval(t,this._interval)},t.prototype._tick=function(){if(this._statusMessage){var t=h.default.timestamp();if(t>this._statusMessageTime){this._statusMessageTime=t+100,this._statusMessageAlpha-=.1;var e=Math.min(1,this._statusMessageAlpha);this._statusMessageColor="rgba("+this.statusMessageRGB+","+e+")",this._statusMessageAlpha<=0&&(this._statusMessage=null)}}this.update(),this.render()},t.prototype.toggleMuted=function(){var t=this.audio.toggleMuted();return this.setStatusMessage(t?"Audio muted":"Audio enabled"),t},t.prototype.toggleShowFps=function(){this.showFps=!this.showFps,this.setStatusMessage("FPS display: "+(this.showFps?"on":"off"))},t.prototype.update=function(){var t=this.inputManager;t.isKeyDown(n.Keys.KEY_SHIFT)&&t.isKeyDown(n.Keys.KEY_F,!0)&&this.toggleShowFps(),this.state.update(this._interval)},t}();e.default=p},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(19),s=function(){function t(t){if(t&&t instanceof n.default)this.game=t;else if(t)this.game=t.game;else{var e=window;this.game=e.game}}return t.prototype.enter=function(t){},t.prototype.leaving=function(t){},t.prototype.update=function(t){},t.prototype.render=function(t){},t}();e.State=s,e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.STRETCH_NONE=0]="STRETCH_NONE",t[t.STRETCH_FILL=1]="STRETCH_FILL",t[t.STRETCH_PROPORTIONAL=2]="STRETCH_PROPORTIONAL"}(e.StretchMode||(e.StretchMode={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.config=t,this.id=-1,this.soundId=void 0,this.source=void 0,this.paused=!1,this.startOffset=-1,this._start=-1,this.playedTime=0}return t.prototype._initFromConfig=function(){var t=this;(this.id=this.config.id,this.soundId=this.config.soundId,this.source=this.config.audioSystem.context.createBufferSource(),this.source.loop=this.config.loop,this.source.buffer=this.config.buffer,this.config.connectTo instanceof AudioNode)?this.source.connect(this.config.connectTo):this.config.connectTo.forEach(function(e){t.source.connect(e)});this.startOffset=this.config.startOffset||0,this.config.loop||(this.source.onended=this.config.onendedGenerator(this.id))},t.prototype.isPaused=function(){return this.paused},t.prototype.pause=function(){this.paused||(this.source.stop(),this.playedTime+=this.source.context.currentTime-this._start,this.paused=!0,this._start=0)},t.prototype.resume=function(){if(this.paused){this.paused=!1;var t=this.startOffset;this._initFromConfig(),this.startOffset=t+this.playedTime,this.startOffset=this.startOffset%this.source.buffer.duration;var e=this.source.context.currentTime;this.source.start(e,this.startOffset),this._start=e,this.playedTime=0}},t.prototype.start=function(){this.paused=!1,this._initFromConfig();var t=this.source.context.currentTime;this.source.start(t,this.startOffset),this._start=t,this.playedTime=0},t}(),s=.3,o=function(){function t(){this._currentMusic=null,this._sounds={},this._musicFade=s,this._fadeMusic=!0,this._muted=!1,this._initialized=!1,this._playingSounds=[],this._soundEffectIdGenerator=0}return t.prototype._createPlayingSound=function(t,e,i,s){var o=this;void 0===e&&(e=!1),void 0===i&&(i=0);var r=this._createSoundEffectId();return new n({audioSystem:this,buffer:this._sounds[t].getBuffer(),connectTo:this._volumeFaderGain,id:r,loop:e,onendedGenerator:function(e){return function(){o._removePlayingSound(e),s&&s(r,t)}},soundId:t,startOffset:i})},t.prototype._createSoundEffectId=function(){return this._soundEffectIdGenerator++},t.prototype.init=function(){var t=window;try{t.AudioContext=t.AudioContext||t.webkitAudioContext,this.context=new t.AudioContext,this._volumeFaderGain=this.context.createGain(),this._volumeFaderGain.gain.setValueAtTime(1,this.context.currentTime),this._volumeFaderGain.gain.value=1,this._volumeFaderGain.connect(this.context.destination),this._initialized=!0}catch(t){console.error("The Web Audio API is not supported in this browser.")}},t.prototype.addSound=function(t){this.context&&(this._sounds[t.getId()]=t)},t.prototype.fadeOutMusic=function(t){var e=this;this.context&&(this._currentMusic?(this._muted||(this._musicFaderGain.gain.setValueAtTime(this._musicFaderGain.gain.value,this.context.currentTime),this._musicFaderGain.gain.linearRampToValueAtTime(0,this.context.currentTime+this._musicFade)),setTimeout(function(){e.playMusic(t)},1e3*this._musicFade)):this.playMusic(t))},t.prototype.getCurrentMusic=function(){return this.currentMusicId},t.prototype.isInitialized=function(){return this._initialized},t.prototype.pauseAll=function(){this._playingSounds.forEach(function(t){t.pause()})},t.prototype.playMusic=function(t,e){if(this.context){if(this._currentMusic&&this.stopMusic(!1),!t)return;var i=this._sounds[t];void 0===e&&(e=i.getLoopsByDefaultIfMusic()),this._musicFaderGain=this.context.createGain(),this._musicFaderGain.gain.setValueAtTime(1,this.context.currentTime),this._musicFaderGain.gain.value=1,this._currentMusic=this.context.createBufferSource(),this._currentMusic.loop=e,this._musicLoopStart=i.getLoopStart()||0,this._currentMusic.loopStart=this._musicLoopStart,this._currentMusic.buffer=i.getBuffer(),this._currentMusic.loopEnd=this._currentMusic.buffer.duration,this._currentMusic.connect(this._musicFaderGain),this._musicFaderGain.connect(this._volumeFaderGain),this._currentMusic.start(0),this.currentMusicId=t,console.log("Just started new music with id: "+t+", loop: "+e)}},t.prototype.playSound=function(t,e,i){if(void 0===e&&(e=!1),this.context){var n=this._createPlayingSound(t,e,0,i);return this._playingSounds.push(n),n.start(),n.id}return-1},t.prototype._removePlayingSound=function(t){for(var e=0;e<this._playingSounds.length;e++)if(this._playingSounds[e].id===t){var i=this._playingSounds[e];return this._playingSounds.splice(e,1),i}return null},t.prototype.resumeAll=function(){for(var t=0;t<this._playingSounds.length;t++){var e=this._playingSounds[t];e.isPaused()&&e.resume()}},t.prototype.stopMusic=function(t){void 0===t&&(t=!1),this._currentMusic&&(this._currentMusic.stop(),t||(this._currentMusic.disconnect(),this._musicFaderGain.disconnect(),delete this._currentMusic,delete this._musicFaderGain))},t.prototype.stopSound=function(t){var e=this._removePlayingSound(t);return!(!e||!e.source)&&(e.source.stop(),!0)},t.prototype.toggleMuted=function(){if(this._muted=!this._muted,this.context){var t=this._muted?0:1;this._volumeFaderGain.gain.setValueAtTime(t,this.context.currentTime),this._volumeFaderGain.gain.value=t}return this._muted},Object.defineProperty(t.prototype,"fadeMusic",{get:function(){return this._fadeMusic},set:function(t){this._fadeMusic=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"musicFadeSeconds",{get:function(){return this._musicFade},set:function(t){this._musicFade=t},enumerable:!0,configurable:!0}),t}();e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),s=i(5),o=function(){function t(t,e){this.atlasInfo=e,this.masterCanvas=t,this.atlasInfo.firstPixelIsTranslucent&&(this.masterCanvas=s.default.makeColorTranslucent(this.masterCanvas))}return t.prototype.parse=function(){var t=this,e={};return this.atlasInfo.images.forEach(function(i){var s,o,r,a,h=i.id;if(i.dim){var u=i.dim.split(/,\s*/);if(4!==u.length)throw new Error("Invalid value for imgInfo "+h+"'s dim: "+i.dim);s=parseInt(u[0],10),o=parseInt(u[1],10),r=parseInt(u[2],10),a=parseInt(u[3],10)}else if(s="number"==typeof i.x?i.x:-1,o="number"==typeof i.y?i.y:-1,"number"==typeof i.s?r=a=i.s:(r="number"==typeof i.w?i.w:-1,a="number"==typeof i.h?i.h:-1),s<0||o<0||r<0||a<0)throw new Error("x, y, w, h (or s) not specified for imgInfo: "+JSON.stringify(i));e[h]=new n.default(t.masterCanvas,s,o,r,a)}),e},t}();e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i){void 0===i&&(i=0),this.id=t,this.buffer=e,this.loopsByDefault=!0,this.loopStart=i}return t.prototype.getBuffer=function(){return this.buffer},t.prototype.getId=function(){return this.id},t.prototype.getLoopsByDefaultIfMusic=function(){return this.loopsByDefault},t.prototype.setLoopsByDefaultIfMusic=function(t){this.loopsByDefault=t},t.prototype.getLoopStart=function(){return this.loopStart},t.prototype.setLoopStart=function(t){this.loopStart=t},t}();e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={getWindowLocationSearch:function(){return window.location.search}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.IMAGE=1]="IMAGE",t[t.AUDIO=2]="AUDIO",t[t.JSON=3]="JSON"}(e.AssetType||(e.AssetType={}))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(12),s=i(26),o=i(3),r=i(5),a=i(11),h=i(24),u=i(23),c=function(){function t(t,e,i){void 0===t&&(t=1),this._scale=t||1,this.loadingAssetData={},this.responses={},this.callback=null,this.audio=e,this._assetRoot=i}return t.prototype.addJson=function(t,e){var i=this;if(void 0===e&&(e=t),this._assetRoot&&(e=this._assetRoot+e),!this._isAlreadyTracked(t)){this.loadingAssetData[t]={type:s.AssetType.JSON},console.log("Adding: "+t+" => "+e+", remaining == "+o.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback));var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var e=n.responseText;i._completed(t,e)}},n.open("GET",e,!0),n.send(null)}},t.prototype.addCanvas=function(t,e){var i=this;this._assetRoot&&(e=this._assetRoot+e);var n=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+o.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),n.addEventListener("load",function(){var e=r.default.resize(n,i._scale);i._completed(t,e)}),n.src=e)},t.prototype.addImage=function(t,e,i){var n=this;void 0===i&&(i=!1),this._assetRoot&&(e=this._assetRoot+e);var h=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+o.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),h.addEventListener("load",function(){var e=r.default.resize(h,n._scale),s=new a.default(e);i&&s.makeColorTranslucent(0,0),n._completed(t,s)}),h.src=e)},t.prototype.addImageAtlasContents=function(t,e,i){var n=this;this._assetRoot&&(e=this._assetRoot+e);var a=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+o.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),a.addEventListener("load",function(){var e=r.default.resize(a,n._scale),s=new u.default(e,i),o="string"==typeof i.prefix?i.prefix:i.prefix?t+".":"",h=s.parse();for(var c in h)h.hasOwnProperty(c)&&(n.responses[o+c]=h[c]);n._completed(t,s)}),a.src=e)},t.prototype.addSound=function(t,e,i,n){var o=this;if(void 0===i&&(i=0),void 0===n&&(n=!0),this.audio.isInitialized()){if(this._isAlreadyTracked(t))return;this.loadingAssetData[t]={type:s.AssetType.AUDIO},this._assetRoot&&(e=this._assetRoot+e);var r=new XMLHttpRequest;r.onload=function(){o.audio.context.decodeAudioData(r.response,function(e){var s=new h.default(t,e,i||0);s.setLoopsByDefaultIfMusic(n),o.audio.addSound(s),o._completed(t,e)})},r.open("GET",e,!0),r.responseType="arraybuffer",r.send(null)}},t.prototype.addSpriteSheet=function(t,e,i,h,u,c,l){var d=this;void 0===u&&(u=0),void 0===c&&(c=0),void 0===l&&(l=!1),u=u||0,c=c||0,i*=this._scale,h*=this._scale,u*=this._scale,c*=this._scale,this._assetRoot&&(e=this._assetRoot+e);var p=document.createElement("img");this._isAlreadyTracked(t)||(this.loadingAssetData[t]={type:s.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+o.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),p.addEventListener("load",function(){var e=r.default.resize(p,d._scale),s=new a.default(e);l&&s.makeColorTranslucent(0,0);var o=new n.default(s,i,h,u,c);d._completed(t,o)}),p.src=e)},t.prototype.addTmxMap=function(t){if(t.tilesets&&t.tilesets.length)for(var e=0;e<t.tilesets.length;e++){var i=t.tilesets[e],n="_tilesetImage_"+i.name;this.addImage(n,i.image)}},t.prototype.getTmxTilesetImage=function(t){return this.responses["_tilesetImage_"+t.name]},t.prototype.get=function(t){return this.responses[t]},t.prototype._isAlreadyTracked=function(t){return this.loadingAssetData[t]?(console.log("A resource with id "+t+" is already loading.  Assuming they are the same"),!0):!!this.responses[t]&&(console.log("A resource with id "+t+" has already been loaded."),!0)},t.prototype.set=function(t,e){this.responses[t]=e},t.prototype._completed=function(t,e){this.loadingAssetData[t]?(this.loadingAssetData[t].type===s.AssetType.JSON&&(e=JSON.parse(e)),this.responses[t]=e,delete this.loadingAssetData[t],console.log("Completed: "+t+", remaining == "+o.default.getObjectSize(this.loadingAssetData)+", callback == "+(null!==this.callback)),this.isDoneLoading()&&this.callback?(this.callback.call(),delete this.callback,console.log("... Callback called and deleted (callback == "+(null!==this.callback)+")"),this.nextCallback&&(this.callback=this.nextCallback,delete this.nextCallback)):console.log("... Not running callback - "+this.isDoneLoading()+", "+(null!==this.callback))):console.error("Resource not found! - "+t)},t.prototype.isDoneLoading=function(){return 0===o.default.getObjectSize(this.loadingAssetData)},t.prototype.onLoad=function(t){this.isDoneLoading()?t():this.callback?this.nextCallback=t:this.callback=t},t}();e.default=c},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s,o=i(2),r=i(6),a=i(43),h=i(41),u=i(40),c=i(39),l=i(38),d=i(37),p=i(36),f=i(8),_=i(0),g=5e4;!function(t){t[t.UPDATE_ALL=0]="UPDATE_ALL",t[t.UPDATE_NONE=1]="UPDATE_NONE",t[t.UPDATE_ONE=2]="UPDATE_ONE"}(s=e.GhostUpdateStrategy||(e.GhostUpdateStrategy={}));var m=function(t){function e(e){var i=t.call(this,e)||this;return i._highScore=g,i.pacman=new a.Pacman,i._ghosts=i._createGhostArray(),i._chompSound=0,i._ghostUpdateStrategy=s.UPDATE_ALL,i._score=0,i._desktopGame=e.desktopGame?e.desktopGame:i._isRunningInElectron(),i._extraPointsArray=[100,200,300,400,500,700,800,1e3,1600,2e3,3e3,5e3],i._possiblyRegisterDesktopModeListeners(),i}return n(e,t),e.prototype.addFruit=function(){this._fruit||(this._fruit=new h.Fruit,this._fruitScoreIndex=-1,this._fruitScoreEndTime=-1)},e.prototype.checkForCollisions=function(){for(var t=0;t<this._ghosts.length;t++)if(this.pacman.intersects(this._ghosts[t]))return this._ghosts[t];return this._fruit&&-1===this._fruitScoreIndex&&this.pacman.intersects(this._fruit)&&(this.increaseScore(this._extraPointsArray[this._fruit.pointsIndex]),this.audio.playSound(r.default.EATING_FRUIT,!1),this._fruitScoreIndex=this._fruit.pointsIndex,this._fruitScoreEndTime=this.playTime+e.SCORE_DISPLAY_LENGTH),null},e.prototype.checkLoopedSound=function(){if(!this._resettingGhostStates){for(var t=!1,e=0;e<this._ghosts.length;e++){if(this._ghosts[e].isEyes())return void this.setLoopedSound(r.default.EYES_RUNNING);this._ghosts[e].isBlue()&&(t=!0)}this.setLoopedSound(t?r.default.CHASING_GHOSTS:r.default.SIREN)}},e.prototype._createGhostArray=function(){var t=[];return this._resettingGhostStates=!0,t.push(new u.Blinky(this)),t.push(new c.Pinky(this)),t.push(new l.Inky(this)),t.push(new d.Clyde(this)),this._resettingGhostStates=!1,t},e.prototype.drawBigDot=function(t,e){var i=this.playTime;if(i<0||i%500>250){var n=this.canvas.getContext("2d");this.assets.get("sprites").drawScaled2(n,135,38,8,8,t,e,8,8)}},e.prototype.drawFruit=function(t){this._fruitScoreIndex>-1?(this.paintPointsEarned(t,this._fruitScoreIndex,this._fruit.x,this._fruit.y),this.playTime>=this._fruitScoreEndTime&&(this._fruit=null,this._fruitScoreIndex=-1,this._fruitScoreEndTime=-1)):this._fruit&&this._fruit.paint(t)},e.prototype.drawGhosts=function(t){this._ghosts.forEach(function(e){e.paint(t)})},e.prototype.drawScores=function(t){var e=this._score.toString(),i=55-8*e.length;this.drawString(i,10,e,t),i=132-8*(e=this._highScore.toString()).length,this.drawString(i,10,e,t)},e.prototype.drawScoresHeaders=function(t){this.drawString(16,0,"1UP",t),this.drawString(67,0,"HIGH SCORE",t)},e.prototype.drawSmallDot=function(t,e){this.canvas.getContext("2d").fillRect(t,e,2,2)},e.prototype.drawSprite=function(t,e,i,n){var s=this.assets.get("sprites"),o=this.canvas.getContext("2d");s.drawScaled2(o,i,n,16,16,t,e,16,16)},e.prototype.drawString=function(t,e,i,n){void 0===n&&(n=this.canvas.getContext("2d"));for(var s,o=i.toString(),r=this.assets.get("font"),a="A".charCodeAt(0),h="0".charCodeAt(0),u=0;u<o.length;u++){var c=o[u],l=o.charCodeAt(u);if(c>="A"&&c<="Z")s=r.colCount+(l-a);else if(c>="0"&&c<="9")s=l-h;else switch(c){case"-":s=10;break;case".":s=11;break;case">":s=12;break;case"@":s=13;break;case"!":s=14;break;default:s=15}r.drawByIndex(n,t,e,s),t+=9}},e.prototype.getGhost=function(t){return this._ghosts[t]},Object.defineProperty(e.prototype,"godMode",{get:function(){return this._godMode},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EXTRA_LIFE_SCORE",{get:function(){return 1e4},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lives",{get:function(){return this._lives},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PENALTY_BOX_EXIT_X",{get:function(){return(this.getWidth()-_.default.SPRITE_SIZE)/2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PENALTY_BOX_EXIT_Y",{get:function(){return 12*_.default.TILE_SIZE-_.default.TILE_SIZE/2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SCORE_DISPLAY_LENGTH",{get:function(){return 750},enumerable:!0,configurable:!0}),e.prototype.ghostEaten=function(t){switch(this._eatenGhostPointsIndex){case 0:this._eatenGhostPointsIndex=1;break;case 1:this._eatenGhostPointsIndex=3;break;case 3:this._eatenGhostPointsIndex=6;break;default:case 6:this._eatenGhostPointsIndex=8}return this.increaseScore(this._extraPointsArray[this._eatenGhostPointsIndex]),this.audio.playSound(r.default.EATING_GHOST),this._eatenGhostPointsIndex},e.prototype.increaseLives=function(t){return this._lives+=t},e.prototype.increaseScore=function(t){this._score+=t,this._score>this._highScore&&(this._highScore=this._score),!this._earnedExtraLife&&this._score>=e.EXTRA_LIFE_SCORE&&(this.audio.playSound(r.default.EXTRA_LIFE),this.increaseLives(1),this._earnedExtraLife=!0)},e.prototype.isDesktopGame=function(){return this._desktopGame},e.prototype._isRunningInElectron=function(){var t=window;return t&&t.process&&t.process.type},e.prototype.loadNextLevel=function(){this.setLoopedSound(null),this._level++,this._fruit=null,this._fruitScoreIndex=-1,this._fruitScoreEndTime=-1,this.state.reset()},e.prototype.makeGhostsBlue=function(){this._eatenGhostPointsIndex=0,this._ghosts.forEach(function(t){t.possiblyTurnBlue()}),this.checkLoopedSound()},e.prototype.paintPointsEarned=function(t,e,i,n){this.assets.get("points").drawByIndex(t,i,n,e)},e.prototype.playChompSound=function(){this.audio.playSound(0===this._chompSound?r.default.CHOMP_1:r.default.CHOMP_2),this._chompSound=(this._chompSound+1)%2},e.prototype._possiblyRegisterDesktopModeListeners=function(){var t=this;this.isDesktopGame()&&window.addEventListener("resize",function(){o.CanvasResizer.resize(t.canvas,t._stretchMode)})},e.prototype.resetGhosts=function(){this._resettingGhostStates=!0;for(var t=[new o.Point(2,1),new o.Point(2,f.Maze.TILE_COUNT_HORIZONTAL-2),new o.Point(f.Maze.TILE_COUNT_VERTICAL-2,1),new o.Point(f.Maze.TILE_COUNT_VERTICAL-2,f.Maze.TILE_COUNT_HORIZONTAL-2)],e=o.Utils.randomInt(4),i=0;i<this._ghosts.length;i++)this._ghosts[i].reset(),this._ghosts[i].setCorner(t[(e+i)%4]);this._resettingGhostStates=!1},e.prototype.setLoopedSound=function(t){t!==this._loopedSoundName&&(null!=this._loopedSoundId&&this.audio.stopSound(this._loopedSoundId),this._loopedSoundName=t,this._loopedSoundId=null!=t?this.audio.playSound(t,!0):null)},Object.defineProperty(e.prototype,"ghostUpdateStrategy",{set:function(t){this._ghostUpdateStrategy=t},enumerable:!0,configurable:!0}),e.prototype.startGame=function(t){this._lives=3,this._score=0,this._level=0;var e=this.assets.get("levels")[t],i=new p.MazeState(e);this.setState(i)},e.prototype.startPacmanDying=function(){this.setLoopedSound(null),this.audio.playSound(r.default.DIES),this.pacman.startDying(),this._fruit=null,this._fruitScoreIndex=-1,this._fruitScoreEndTime=-1},e.prototype.toggleGodMode=function(){return this._godMode=!this._godMode,this.setStatusMessage("God mode "+(this._godMode?"enabled":"disabled")),this._godMode},e.prototype.toggleStretchMode=function(){if(this.isDesktopGame()){switch(this._stretchMode){default:case o.StretchMode.STRETCH_NONE:this._stretchMode=o.StretchMode.STRETCH_FILL;break;case o.StretchMode.STRETCH_FILL:this._stretchMode=o.StretchMode.STRETCH_PROPORTIONAL;break;case o.StretchMode.STRETCH_PROPORTIONAL:this._stretchMode=o.StretchMode.STRETCH_NONE}this.setStatusMessage("Stretch mode: "+o.StretchMode[this._stretchMode]),o.CanvasResizer.resize(this.canvas,this._stretchMode)}},e.prototype.updateSpriteFrames=function(){this.pacman.updateFrame(),this._ghosts.forEach(function(t){t.updateFrame()})},e.prototype.updateSpritePositions=function(t,e){switch(this._ghostUpdateStrategy){case s.UPDATE_ALL:this._ghosts.forEach(function(i){i.updatePosition(t,e)});break;case s.UPDATE_NONE:break;case s.UPDATE_ONE:this._ghosts[0].updatePosition(t,e)}this.pacman.updatePosition(t,e)},e}(o.Game);e.PacmanGame=m},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var s,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(s=0===o.indexOf("//")?o:0===o.indexOf("/")?i+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")})}},function(t,e,i){var n={},s=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),o=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),r=null,a=0,h=[],u=i(29);function c(t,e){for(var i=0;i<t.length;i++){var s=t[i],o=n[s.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](s.parts[r]);for(;r<s.parts.length;r++)o.parts.push(g(s.parts[r],e))}else{var a=[];for(r=0;r<s.parts.length;r++)a.push(g(s.parts[r],e));n[s.id]={id:s.id,refs:1,parts:a}}}}function l(t,e){for(var i=[],n={},s=0;s<t.length;s++){var o=t[s],r=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[r]?n[r].parts.push(a):i.push(n[r]={id:r,parts:[a]})}return i}function d(t,e){var i=o(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=h[h.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),h.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=o(t.insertInto+" "+t.insertAt.before);i.insertBefore(e,s)}}function p(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=h.indexOf(t);e>=0&&h.splice(e,1)}function f(t){var e=document.createElement("style");return void 0===t.attrs.type&&(t.attrs.type="text/css"),_(e,t.attrs),d(t,e),e}function _(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function g(t,e){var i,n,s,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var h=a++;i=r||(r=f(e)),n=y.bind(null,i,h,!1),s=y.bind(null,i,h,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",_(e,t.attrs),d(t,e),e}(e),n=function(t,e,i){var n=i.css,s=i.sourceMap,o=void 0===e.convertToAbsoluteUrls&&s;(e.convertToAbsoluteUrls||o)&&(n=u(n));s&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var r=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(r),a&&URL.revokeObjectURL(a)}.bind(null,i,e),s=function(){p(i),i.href&&URL.revokeObjectURL(i.href)}):(i=f(e),n=function(t,e){var i=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),s=function(){p(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else s()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=l(t,e);return c(i,e),function(t){for(var s=[],o=0;o<i.length;o++){var r=i[o];(a=n[r.id]).refs--,s.push(a)}t&&c(l(t,e),e);for(o=0;o<s.length;o++){var a;if(0===(a=s[o]).refs){for(var h=0;h<a.parts.length;h++)a.parts[h]();delete n[a.id]}}}};var m=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}();function y(t,e,i,n){var s=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=m(e,s);else{var o=document.createTextNode(s),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(o,r[e]):t.appendChild(o)}}},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var s=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),o=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[i].concat(o).concat([s]).join("\n")}return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},s=0;s<this.length;s++){var o=this[s][0];"number"==typeof o&&(n[o]=!0)}for(s=0;s<t.length;s++){var r=t[s];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),e.push(r))}},e}},function(t,e,i){(t.exports=i(31)(!1)).push([t.i,"body,html{margin:0;padding:0;width:100%;height:100%;font-family:Open Sans,sans-serif;font-size:14px}h1{margin-top:0}h3{margin:0;padding:.5rem;text-align:left}h4{margin-bottom:0}#parent{margin-bottom:3rem}.content{width:600px;margin:0 auto;text-align:center}.panel{border:1px solid silver;border-radius:5px}.panel-header{background:#e0e0e0;border-bottom:1px solid silver}.panel-footer{border-top:1px solid silver;padding:.2rem 0;margin-top:2rem;font-size:smaller}.info{width:20rem;margin:0 auto;text-align:initial}canvas{image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:pixelated;image-rendering:crisp-edges;-ms-interpolation-mode:nearest-neighbor}",""])},function(t,e,i){var n=i(32);"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(30)(n,s);n.locals&&(t.exports=n.locals)},function(t,e){t.exports="<!doctype html>\n<html>\n\n<head>\n   <title>Pacman</title>\n   <meta charset=\"UTF-8\">\n   <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>\n\n    <script>\n        window.onload = function() {\n            init('parent');\n        };\n    <\/script>\n\n</head>\n\n<body>\n\n  <div class='content'>\n\n    <h1>Pacman in your browser!</h1>\n\n    <div id='parent'></div>\n\n    <div class='panel'>\n\n      <div class='panel-header'>\n        <h3>How to Play</h3>\n      </div>\n\n      <div class='info'>\n\n        <h4>Controls:</h4>\n        <ol>\n          <li><b>Enter:</b> Start game / Pause\n          <li><b>Arrow Keys:</b> Move around\n          <li><b>M:</b> Toggle sound (mute)\n        </ol>\n\n        <h4>Cheats:</h4>\n        <ul>\n          <li><b>Z + X</b>: Next level\n          <li><b>Z + C</b>: Commit suicide\n          <li><b>Z + G</b>: Toggle God Mode\n        </ul>\n\n      </div>\n\n      <div class='panel-footer'>\n        Build date: <%=build.date%>\n      </div>\n    </div>\n\n  </div>\n</body>\n\n</html>\n"},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(7),o=i(6),r=i(13),a=i(2),h=function(t){return parseInt(t,16)},u=function(t){function e(e){var i=t.call(this,e)||this;return i._assetsLoaded=!1,i}return n(e,t),e.prototype.update=function(t){var e=this;if(this.handleDefaultKeys(),!this._assetsLoaded){this._assetsLoaded=!0;var i=this.game;i.assets.addImage("loading","res/loadingMessage.png"),i.assets.onLoad(function(){i.assets.addImage("title","res/title.png"),i.assets.addSpriteSheet("font","res/font.png",9,7,0,0),i.assets.addImage("sprites","res/sprite_tiles.png",!0),i.assets.addSpriteSheet("mapTiles","res/map_tiles.png",8,8,0,0),i.assets.addSpriteSheet("points","res/points.png",18,9,0,0),i.assets.addJson("levels","res/levelData.json"),i.assets.addSound(o.default.CHASING_GHOSTS,"res/sounds/chasing_ghosts.wav"),i.assets.addSound(o.default.CHOMP_1,"res/sounds/chomp_1.wav"),i.assets.addSound(o.default.CHOMP_2,"res/sounds/chomp_2.wav"),i.assets.addSound(o.default.DIES,"res/sounds/dies.wav"),i.assets.addSound(o.default.EATING_FRUIT,"res/sounds/eating_fruit.wav"),i.assets.addSound(o.default.EATING_GHOST,"res/sounds/eating_ghost.wav"),i.assets.addSound(o.default.EXTRA_LIFE,"res/sounds/extra_life.wav"),i.assets.addSound(o.default.EYES_RUNNING,"res/sounds/eyes_running.wav"),i.assets.addSound(o.default.INTERMISSION,"res/sounds/intermission.wav"),i.assets.addSound(o.default.OPENING,"res/sounds/opening.wav"),i.assets.addSound(o.default.SIREN,"res/sounds/siren.wav"),i.assets.addSound(o.default.TOKEN,"res/sounds/token.wav"),i.assets.onLoad(function(){for(var t=i.assets.get("levels"),n=0;n<t.length;n++)for(var s=0;s<t[n].length;s++)t[n][s]=t[n][s].map(h);null!==a.Utils.getRequestParam("skipTitle")?e.game.startGame(0):i.setState(new a.FadeOutInState(e,new r.TitleState))})})}},e}(s._BaseState);e.LoadingState=u},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(7),o=i(8),r=i(28),a=i(13),h=i(6),u=i(4),c=i(2),l=i(0),d=function(t){function e(e){var i=t.call(this)||this;return i._mazeFile=e,i}return n(e,t),Object.defineProperty(e,"DYING_FRAME_DELAY_MILLIS",{get:function(){return 75},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_readyDelayMillis",{get:function(){return this._firstTimeThrough?4500:2e3},enumerable:!0,configurable:!0}),e.prototype.enter=function(){game.pacman.reset(),game.resetGhosts(),this._maze=new o.Maze(this._mazeFile),this._firstTimeThrough=!0,this._updateScoreIndex=-1,this._lastMazeScreenKeypressTime=game.playTime+e.INPUT_REPEAT_MILLIS,this._substate="READY",this._firstTimeThrough=!0,this._substateStartTime=0,this._nextDyingFrameTime=0,this._nextUpdateTime=0,this._lastSpriteFrameTime=0},e.prototype._paintExtraLives=function(t){var e=game.lives;if(e>0)for(var i=24,n=game.getHeight()-16,s=0;s<e;s++)game.drawSprite(i,n,192,48),i+=16},e.prototype._paintPossibleFruits=function(t){var e=l.default.TILE_SIZE,i=game.getWidth()-12-2*e,n=game.getHeight()-2*e;switch(game.level){default:case 7:game.drawSprite(i-112,n,208,48);case 6:game.drawSprite(i-96,n,208,96);case 5:game.drawSprite(i-80,n,192,96);case 4:game.drawSprite(i-64,n,208,32);case 3:game.drawSprite(i-48,n,208,80);case 2:game.drawSprite(i-32,n,192,80);case 1:game.drawSprite(i-16,n,208,64);case 0:game.drawSprite(i,n,192,64)}},e.prototype.render=function(e){t.prototype.render.call(this,e),this._maze.render(e);var i=game.getHeight()-16-8*o.Maze.TILE_COUNT_VERTICAL;e.translate(0,i),game.drawFruit(e);var n=game.pacman;if(-1===this._updateScoreIndex)"GAME_OVER"!==this._substate&&n.render(e);else{var s=n.bounds.x,r=n.bounds.y;game.paintPointsEarned(e,this._updateScoreIndex,s,r)}if(game.drawGhosts(e),e.translate(0,-i),game.drawScores(e),this._paintExtraLives(e),this._paintPossibleFruits(e),"READY"===this._substate){s=(game.getWidth()-9*"READY!".length)/2;s+=3,game.drawString(s,160,"READY!")}else if("GAME_OVER"===this._substate){s=(game.getWidth()-9*"GAME OVER".length)/2;game.drawString(s,160,"GAME OVER")}if(game.paused){e.globalAlpha=.4,e.fillStyle="black",e.fillRect(0,0,game.getWidth(),game.getHeight()),e.globalAlpha=1,e.fillRect(50,100,game.getWidth()-100,game.getHeight()-200);s=(game.getWidth()-9*"PAUSED".length)/2;game.drawString(s,(game.getHeight()-18)/2,"PAUSED")}},e.prototype.reset=function(){this._maze.reset(),game.resetPlayTime(),game.pacman.reset(),game.resetGhosts(),this._substate="READY",this._substateStartTime=0,this._lastSpriteFrameTime=0,this._lastMazeScreenKeypressTime=game.playTime+e.INPUT_REPEAT_MILLIS},e.prototype._handleInput=function(t,i){this.handleDefaultKeys();var n=game.inputManager;if("GAME_OVER"!==this._substate&&n.enter(!0))return game.paused=!game.paused,void(this._lastMazeScreenKeypressTime=i);if(!game.paused)switch(this._substate){case"IN_GAME":game.pacman.handleInput(this._maze);break;case"GAME_OVER":n.enter(!0)&&game.setState(new a.TitleState(game))}i>=this._lastMazeScreenKeypressTime+e.INPUT_REPEAT_MILLIS&&!game.paused&&"IN_GAME"===this._substate&&n.isKeyDown(c.Keys.KEY_Z)&&(n.isKeyDown(c.Keys.KEY_X)?(game.loadNextLevel(),this._lastMazeScreenKeypressTime=i):n.isKeyDown(c.Keys.KEY_C)&&"DYING"!==this._substate&&(game.startPacmanDying(),this._substate="DYING",this._nextDyingFrameTime=i+e.DYING_FRAME_DELAY_MILLIS,this._lastMazeScreenKeypressTime=i))},e.prototype.update=function(i){t.prototype.update.call(this,i),this._handleInput(i,game.playTime);var n=game.playTime;switch(this._substate){case"READY":this._firstTimeThrough&&0===this._substateStartTime&&(this._substateStartTime=n,game.audio.playSound(h.default.OPENING)),n>=this._substateStartTime+this._readyDelayMillis&&(this._substate="IN_GAME",this._substateStartTime=n,game.resetPlayTime(),this._lastMazeScreenKeypressTime=game.playTime,game.setLoopedSound(h.default.SIREN),this._firstTimeThrough=!1);break;case"IN_GAME":this._updateInGameImpl(n);break;case"DYING":n>=this._nextDyingFrameTime&&(game.pacman.incDying()?this._nextDyingFrameTime=n+e.DYING_FRAME_DELAY_MILLIS:game.increaseLives(-1)<=0?this._substate="GAME_OVER":(game.resetPlayTime(),this._lastMazeScreenKeypressTime=game.playTime,game.pacman.reset(),game.resetGhosts(),this._substate="READY",this._substateStartTime=0,this._lastSpriteFrameTime=0))}},e.prototype._updateInGameImpl=function(t){if(!(this._nextUpdateTime>0&&t<this._nextUpdateTime)){this._nextUpdateTime=0,this._updateScoreIndex=-1,this._updateSpriteFrames(),game.updateSpritePositions(this._maze,t);var i=game.checkForCollisions();if(i)switch(i.motionState){case u.MotionState.BLUE:this._nextUpdateTime=t+r.PacmanGame.SCORE_DISPLAY_LENGTH,i.motionState=u.MotionState.EYES,this._updateScoreIndex=game.ghostEaten(i);break;case u.MotionState.EYES:case u.MotionState.EYES_ENTERING_BOX:break;default:game.godMode||(game.startPacmanDying(),this._substate="DYING",this._nextDyingFrameTime=game.playTime+e.DYING_FRAME_DELAY_MILLIS)}}},e}(s._BaseState);e.MazeState=d},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(4),o=i(1),r=i(0),a=function(t){function e(e){return t.call(this,e,3*r.default.SPRITE_SIZE,14)||this}return n(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=o.Direction.SOUTH,this.setLocation(16*r.default.TILE_SIZE-r.default.TILE_SIZE/2-4,15*r.default.TILE_SIZE-r.default.TILE_SIZE/2),this.motionState=s.MotionState.IN_BOX},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount;this.atIntersection(t)?this.changeDirectionFallback(t):this.continueInCurrentDirection(e),game.playTime>=this.startScatteringTime&&(this.motionState=s.MotionState.SCATTERING)},e}(s.Ghost);e.Clyde=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(4),o=i(1),r=i(0),a=function(t){function e(e){return t.call(this,e,1*r.default.SPRITE_SIZE,8)||this}return n(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=o.Direction.SOUTH,this.setLocation(12*r.default.TILE_SIZE-r.default.TILE_SIZE/2-4,15*r.default.TILE_SIZE-r.default.TILE_SIZE/2),this.motionState=s.MotionState.IN_BOX},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,n=this.column,r=game.getGhost(0),a=r.row,h=r.column;if((h-n)*(h-n)+(a-i)*(a-i)<=35){var u=game.pacman.row,c=game.pacman.column,l=t.getPathBreadthFirst(i,n,u,c);null==l?this.changeDirectionFallback(t):l.col<n?(this.direction=o.Direction.WEST,this.incX(-e)):l.col>n?(this.direction=o.Direction.EAST,this.incX(e)):l.row<i?(this.direction=o.Direction.NORTH,this.incY(-e)):l.row>i&&(this.direction=o.Direction.SOUTH,this.incY(e))}else this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.startScatteringTime&&(this.motionState=s.MotionState.SCATTERING)},e}(s.Ghost);e.Inky=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(4),o=i(1),r=i(0),a=function(t){function e(e){return t.call(this,e,2*r.default.SPRITE_SIZE,2)||this}return n(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=o.Direction.NORTH,this.setLocation(14*r.default.TILE_SIZE-r.default.TILE_SIZE/2-4,15*r.default.TILE_SIZE-r.default.TILE_SIZE/2),this.motionState=s.MotionState.IN_BOX},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount,i=game.pacman,n=i.row,r=i.column,a=this.row,h=this.column,u=!1;this.atIntersection(t)?(a===n&&t.isClearShotRow(a,h,r)?(r<h?(this.direction=o.Direction.WEST,this.incX(-e)):this.goRightIfPossible(t,e)||this.changeDirectionFallback(t),u=!0):h===r&&t.isClearShotColumn(h,a,n)&&(n<a?(this.direction=o.Direction.NORTH,this.incY(-e)):this.goDownIfPossible(t,e)||this.changeDirectionFallback(t),u=!0),u||this.changeDirectionFallback(t)):this.continueInCurrentDirection(e),game.playTime>=this.startScatteringTime&&(this.motionState=s.MotionState.SCATTERING)},e}(s.Ghost);e.Pinky=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(4),o=i(1),r=i(0),a=function(t){function e(e){return t.call(this,e,0*r.default.SPRITE_SIZE,0)||this}return n(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=o.Direction.WEST,this.setLocation(this.game.PENALTY_BOX_EXIT_X,this.game.PENALTY_BOX_EXIT_Y),this.motionState=s.MotionState.SCATTERING},e.prototype.updatePositionChasingPacman=function(t){var e=this.moveAmount;if(this.atIntersection(t)){var i=this.row,n=this.column,r=this.game.pacman.row,a=this.game.pacman.column,h=t.getPathBreadthFirst(i,n,r,a);null==h?this.changeDirectionFallback(t):h.col<n?(this.direction=o.Direction.WEST,this.incX(-e)):h.col>n?(this.direction=o.Direction.EAST,this.incX(e)):h.row<i?(this.direction=o.Direction.NORTH,this.incY(-e)):h.row>i&&(this.direction=o.Direction.SOUTH,this.incY(e))}else this.continueInCurrentDirection(e);this.game.playTime>=this.startScatteringTime&&(this.motionState=s.MotionState.SCATTERING)},e}(s.Ghost);e.Blinky=a},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(9),o=i(0),r=function(t){function e(){var i=t.call(this,1)||this;i.setLocation(game.PENALTY_BOX_EXIT_X,140);var n=game.level;return n>7&&(n=game.randomInt(8)),i._col=e.COLS[n],i._row=e.ROWS[n],i._pointsIndex=e.PTS_INDEX[n],i}return n(e,t),Object.defineProperty(e.prototype,"pointsIndex",{get:function(){return this._pointsIndex},enumerable:!0,configurable:!0}),e.prototype.getUpdateDelayMillis=function(){return 1e11},e.prototype.paint=function(t){var e=o.default.SPRITE_SIZE,i=this._col*e,n=this._row*e;game.drawSprite(this.x,this.y,i,n)},e.prototype.updatePositionImpl=function(t){},e.COLS=[12,13,12,13,13,12,13,13],e.ROWS=[4,4,5,5,2,6,6,3],e.PTS_INDEX=[0,2,4,5,10,7,9,11],e}(s._BaseSprite);e.Fruit=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.row=t,this.col=e}return t.prototype.equals=function(t){return this.row===t.row&&this.col===t.col},t.prototype.set=function(t,e,i){this.row=t,this.col=e,this.parent=i},t.prototype.toString=function(){return"[MazeNode: ("+this.row+","+this.col+")]"},t}();e.MazeNode=n},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=i(1),o=i(9),r=i(0),a=function(t){function e(){var e=t.call(this,3)||this;return e._dyingFrame=0,e}return n(e,t),e.prototype.getUpdateDelayMillis=function(){return 10},e.prototype.handleInput=function(t){var e=game.inputManager;e.left()?this.getCanMoveLeft(t)&&(this.direction=s.Direction.WEST):e.right()&&this.getCanMoveRight(t)&&(this.direction=s.Direction.EAST),e.up()?this.getCanMoveUp(t)&&(this.direction=s.Direction.NORTH):e.down()&&this.getCanMoveDown(t)&&(this.direction=s.Direction.SOUTH)},e.prototype.incDying=function(){return this._dyingFrame=(this._dyingFrame+1)%12,0!==this._dyingFrame},e.prototype.render=function(t){var e,i,n=r.default.SPRITE_SIZE,s=this.bounds.x,o=this.bounds.y;this._dyingFrame>0?(e=n*this._dyingFrame,i=96):(e=this.direction*n*this.getFrameCount()+this.getFrame()*n,i=80),game.drawSprite(s,o,e,i)},e.prototype.reset=function(){t.prototype.reset.call(this),this.direction=s.Direction.WEST,this.setLocation(104,188),this._frame=0},e.prototype.setLocation=function(e,i){t.prototype.setLocation.call(this,e,i)},e.prototype.startDying=function(){this._dyingFrame=1},e.prototype.updatePositionImpl=function(t){var e=this.moveAmount;switch(this.direction){case s.Direction.WEST:this.goLeftIfPossible(t,e);break;case s.Direction.EAST:this.goRightIfPossible(t,e);break;case s.Direction.NORTH:this.goUpIfPossible(t,e);break;case s.Direction.SOUTH:this.goDownIfPossible(t,e)}game.increaseScore(t.checkForDot(this.row,this.column))},e}(o._BaseSprite);e.Pacman=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(14),s=i(16),o=function(){function t(t,e){this.rowCount=t.height,this.colCount=t.width,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.screenWidth=e.screenWidth,this.screenHeight=e.screenHeight,this.screenRows=Math.ceil(this.screenHeight/this.tileHeight),this.screenCols=Math.ceil(this.screenWidth/this.tileWidth);var i=e?e.imagePathModifier:null;this.layers=[],this.layersByName={},this.objectGroups=[];for(var s=0;s<t.layers.length;s++)this.addLayer(t.layers[s]);if(this.tilesets=[],t.tilesets&&t.tilesets.length)for(s=0;s<t.tilesets.length;s++)this.tilesets.push(new n.default(t.tilesets[s],i));this.properties=t.properties,this.version=t.version,this.orientation=t.orientation}return t.prototype.addLayer=function(t){var e=new s.default(this,t);this.layers.push(e),this.layersByName[e.name]=e,e.isObjectGroup()&&this.objectGroups.push(e)},t.prototype.draw=function(t,e,i,n,s){void 0===n&&(n=0),void 0===s&&(s=0);var o=this.colCount,r=this.rowCount,a=this.screenRows,h=this.screenCols,u=this.tileWidth,c=this.tileHeight,l=u,d=this.screenWidth,p=this.screenHeight,f=i-Math.floor(a/2);f<0&&(f+=o);var _=e-Math.floor(h/2);_<0&&(_+=r);var g=i*u+n+u/2-d/2,m=e*c+s+c/2-p/2,y=Math.floor(g/u);g%l<0&&y--;var v=y*u,S=Math.floor(m/c);m%l<0&&S--;var E=v-g,T=E,b=S*c-m;y<0&&(y+=o),S<0&&(S+=r);for(var I=S,w=this.getLayerCount();b<p;){for(var O=0;O<w;O++){var M=y;T=E;var P=this.getLayerByIndex(O);if(P.visible){var A=1;for(P.opacity<1&&(A=t.globalAlpha,t.globalAlpha=A*P.opacity);T<d;){var C=P.getData(I%r,M%o);this.drawTile(t,T,b,C,P),T+=u,M++}P.opacity<1&&(t.globalAlpha=A)}}b+=c,I++}},t.prototype.getLayer=function(t){return this.layersByName[t]},t.prototype.getLayerByIndex=function(t){return this.layers[t]},t.prototype.getLayerCount=function(){return this.layers.length},t.prototype._getImageForGid=function(t){for(var e=this.tilesets.length,i=0;i<e;i++)if(this.tilesets[i].firstgid>t)return this.tilesets[i-1];return this.tilesets[e-1]},t.prototype.drawTile=function(t,e,i,n,s){if(!(n<=0)){var o=this._getImageForGid(n);if(o){if(!((n-=o.firstgid)<0)){var r=window.game.assets.getTmxTilesetImage(o),a=this.tileWidth,h=a+o.spacing,u=this.tileHeight,c=u+o.spacing,l=Math.floor(r.width/h);o.spacing>0&&r.width%h===a&&l++;var d=Math.floor(n/l)*c,p=n%l*h;r.drawScaled2(t,p,d,a,u,e,i,a,u)}}else console.log("null tileset for: "+n+" (layer "+s.name+")")}},t.prototype.setScale=function(t){this.tileWidth*=t,this.tileHeight*=t,this.screenRows=Math.ceil(this.screenHeight/this.tileHeight),this.screenCols=Math.ceil(this.screenWidth/this.tileWidth);for(var e=this.tilesets.length,i=0;i<e;i++)this.tilesets[i].setScale(t)},t.prototype.getPixelWidth=function(){return this.colCount*this.tileWidth},t.prototype.getPixelHeight=function(){return this.rowCount*this.tileHeight},t.prototype.removeLayer=function(t){for(var e=0;e<this.layers.length;e++){if(this.layers[e].name===t){this.layers.splice(e,1),delete this.layersByName[t];for(var i=0;i<this.objectGroups.length;i++)this.objectGroups[i].name===t&&delete this.objectGroups[i]}return!0}return!1},t}();e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.set(t,e,i,n)}return t.prototype.contains=function(t,e){return t>=this.x&&t<this.x+this.w&&e>=this.y&&e<this.y+this.h},t.prototype.containsRect=function(t,e,i,n){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),"number"!=typeof t){var s=t;e=s.y,i=s.w,n=s.h,t=s.x}var o=this.w,r=this.h;if((o|r|i|n)<0)return!1;var a=this.x,h=this.y;if(t<a||e<h)return!1;if(o+=a,(i+=t)<=t){if(o>=a||i>o)return!1}else if(o>=a&&i>o)return!1;if(r+=h,(n+=e)<=e){if(r>=h||n>r)return!1}else if(r>=h&&n>r)return!1;return!0},t.prototype.intersects=function(t){var e=this.w,i=this.h,n=t.w,s=t.h;if(n<=0||s<=0||e<=0||i<=0)return!1;var o=this.x,r=this.y,a=t.x,h=t.y;return s+=h,e+=o,i+=r,((n+=a)<a||n>o)&&(s<h||s>r)&&(e<o||e>a)&&(i<r||i>h)},t.prototype.set=function(t,e,i,n){"number"==typeof t?(this.x=t,void 0!==e&&(this.y=e),void 0!==i&&(this.w=i),void 0!==n&&(this.h=n)):(this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h)},t}();e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i){void 0===e&&(e=20),void 0===i&&(i=10),this._c=t,this._pool=[];for(var n=0;n<e;n++)this._pool.push(new this._c);this._index=0,this._growCount=i}return t.prototype.borrowObj=function(){var t=this._pool[this._index++];if(this._index>=this._pool.length)for(var e=0;e<this._growCount;e++)this._pool.push(new this._c);return t},Object.defineProperty(t.prototype,"borrowedCount",{get:function(){return this._index},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this._index=0},t.prototype.returnObj=function(t){for(var e=-1,i=0;i<this._index;i++)if(t===this._pool[i]){e=i;break}if(-1===e)return!1;var n=this._pool[--this._index];return this._pool[this._index]=this._pool[e],this._pool[e]=n,!0},Object.defineProperty(t.prototype,"length",{get:function(){return this._pool.length},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"[Pool: borrowed="+this.borrowedCount+", size="+this.length+"]"},t}();e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.equals=function(t){return!!t&&this.x===t.x&&this.y===t.y},t}();e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),s=function(){function t(){this._paused=!1,this.pauseStart=0,this._updating=!0,this.notUpdatingStart=0,this.startShift=0}return Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){if(this._paused!==t)if(this._paused=t,t)this.pauseStart=n.default.timestamp();else{var e=n.default.timestamp()-this.pauseStart;this.startShift+=e,this.pauseStart=0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playTime",{get:function(){return 0!==this.pauseStart?this.pauseStart-this.startShift:0!==this.notUpdatingStart?this.notUpdatingStart-this.startShift:n.default.timestamp()-this.startShift},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._updating},set:function(t){if(this._updating!==t&&(this._updating=t,!this.paused))if(this._updating){var e=n.default.timestamp()-this.notUpdatingStart;this.startShift+=e,this.notUpdatingStart=0}else this.notUpdatingStart=n.default.timestamp()},enumerable:!0,configurable:!0}),t.prototype.resetPlayTime=function(){if(this.paused||!this.updating)throw"Cannot reset playtime millis when paused or not updating";this.startShift=n.default.timestamp()},t.prototype.start=function(){this.startShift=n.default.timestamp()},t}();e._GameTimer=s},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=800,o=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r._leavingState=e,r._enteringState=i,r._transitionLogic=n,r._fadingOut=!0,r._alpha=1,r._halfTime=o&&o>0?o/2:s,r._curTime=0,r}return n(e,t),e.prototype.update=function(e){if(t.prototype.update.call(this,e),this._curTime+=e,this._curTime>=this._halfTime){if(this._curTime-=this._halfTime,!this._fadingOut)return void this._setState(this._enteringState);this._fadingOut=!1,this._transitionLogic&&this._transitionLogic()}this._alpha=this._fadingOut?1-this._curTime/this._halfTime:this._curTime/this._halfTime},e.prototype.render=function(e){t.prototype.render.call(this,e),this.game.clearScreen();var i=e.globalAlpha;e.globalAlpha=this._alpha,this._fadingOut?this._leavingState.render(e):this._enteringState.render(e),e.globalAlpha=i},e.prototype._setState=function(t){this.game.setState(this._enteringState)},e}(i(20).default);e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){if(!t||!t.millis)throw'Missing required "millis" argument to Delay';this._initial=t.millis.length?t.millis:[t.millis],this._initialIndex=0,t.minDelta&&t.maxDelta&&this.setRandomDelta(t.minDelta,t.maxDelta),this._callback=t.callback,this._loop=!!t.loop,this._loopCount=0,this._maxLoopCount=this._loop&&t.loopCount||-1,this._remaining=0,this._curInitial=0,this.reset()}return t.prototype.update=function(t){return this._remaining>0&&(this._remaining-=t,this._remaining<=0&&this._callback&&this._callback(this)),this._remaining<=0&&(this._loop?-1===this._maxLoopCount||this._loopCount<this._maxLoopCount-1?(this._loopCount++,this.reset(!0)):(this._loopCount=this._maxLoopCount,this._remaining=-1):this._remaining=Math.max(0,this._remaining)),this.isDone()},t.prototype.getLoopCount=function(){return this._loopCount},t.prototype.getMaxDelta=function(){return void 0!==this._maxDelta?this._maxDelta:-1},t.prototype.getMinDelta=function(){return void 0!==this._minDelta?this._minDelta:-1},t.prototype.getRemaining=function(){return this._remaining},t.prototype.getRemainingPercent=function(){return this._remaining/this._curInitial},t.prototype.isDone=function(){return(!this._loop||this._loopCount===this._maxLoopCount)&&this._remaining<=0},t.prototype.setRandomDelta=function(t,e){this._minDelta=t,this._maxDelta=e},t.prototype.reset=function(t){t=!!t;var e=this._remaining;this._curInitial=this._remaining=this._initial[this._initialIndex],t&&e<0&&(this._remaining+=e),this._initialIndex=(this._initialIndex+1)%this._initial.length,this._minDelta||this._maxDelta},t.prototype.toString=function(){return"[Delay: _initial="+this._initial+", _remaining="+this._remaining+", _loop="+this._loop+", _callback="+!!this._callback+"]"},t}();e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(21);e.default={resize:function(t,e){switch(e){default:case n.StretchMode.STRETCH_NONE:t.style.width=t.width+"px",t.style.height=t.height+"px";break;case n.StretchMode.STRETCH_FILL:t.style.width=document.body.clientWidth+"px",t.style.height=document.body.clientHeight+"px";break;case n.StretchMode.STRETCH_PROPORTIONAL:var i=document.body.clientWidth/(1*t.width),s=document.body.clientHeight/(1*t.height),o=Math.min(i,s);t.style.width=Math.floor(t.width*o)+"px",t.style.height=Math.floor(t.height*o)+"px"}}}},function(t,e,i){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,i,n,s,o){return t.call(this,e,i,n,s,o)||this}return n(e,t),e.prototype.drawString=function(t,e,i){for(var n=this.size,s=window.game.canvas.getContext("2d"),o=this.cellW,r=0;r<t.length;r++){var a=t.charCodeAt(r)-32;(a<0||a>=n)&&(a=0),this.drawByIndex(s,e,i,a),e+=o}},e}(i(12).default);e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(28),s=i(35);i(34),i(33);window.init=function(t,e){var i=window;i.game=new n.PacmanGame({parent:t,width:224,height:288,assetRoot:e,keyRefreshMillis:300,targetFps:60}),i.game.setState(new s.LoadingState),i.game.start()}},function(t,e,i){t.exports=i(53)}]);