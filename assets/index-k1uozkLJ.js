(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},f={},J={},W={};Object.defineProperty(W,"__esModule",{value:!0});var Ut=function(){function s(t,e,i,n,r,o){n===void 0&&(n=1),r===void 0&&(r=n),o===void 0&&(o=1),this.gtpImage=t,this.cellW=e,this.cellH=i,this.spacingX=n,this.spacingY=r,o!==1&&(this.cellW*=o,this.cellH*=o,this.spacingX*=o,this.spacingY*=o),this.rowCount=Math.floor(t.height/(this.cellH+this.spacingY)),t.height-this.rowCount*(this.cellH+this.spacingY)>=this.cellH&&this.rowCount++,this.colCount=Math.floor(t.width/(this.cellW+this.spacingX)),t.width-this.colCount*(this.cellW+this.spacingX)>=this.cellW&&this.colCount++,this.size=this.rowCount*this.colCount}return s.prototype.drawSprite=function(t,e,i,n,r){var o=this.cellW,a=this.cellH,h=(o+this.spacingX)*r,c=(a+this.spacingY)*n;this.gtpImage.drawScaled2(t,h,c,o,a,e,i,o,a)},s.prototype.drawByIndex=function(t,e,i,n){var r=Math.floor(n/this.colCount),o=Math.floor(n%this.colCount);this.drawSprite(t,e,i,r,o)},s}();W.default=Ut;var St={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.AssetType=void 0,function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.IMAGE=1]="IMAGE",t[t.AUDIO=2]="AUDIO",t[t.JSON=3]="JSON"}(s.AssetType||(s.AssetType={}))})(St);var M={},Q={};Object.defineProperty(Q,"__esModule",{value:!0});Q.default={getWindowLocationSearch:function(){return window.location.search}};Object.defineProperty(M,"__esModule",{value:!0});var Ht=Q;M.default={getObjectSize:function(s){return Object.keys(s).length},getRequestParam:function(s){var t="&"+Ht.default.getWindowLocationSearch().substring(1),e="&"+s,i=t.indexOf(e);if(i>=-1){var n=i+e.length;if(t.charAt(n)==="="){n++;var r=t.indexOf("&",n);return r===-1&&(r=t.length),t.substring(n,r)}if(t.charAt(n)==="&"||n===t.length)return""}return null},hitch:function(s,t){return function(){t.apply(s,arguments)}},mixin:function(s,t){for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(t[e]=s[e])},randomInt:function(s,t){var e,i;return typeof t>"u"?(e=0,i=s):(e=s,i=t),Math.floor(Math.random()*(i-e))+e},timestamp:function(){return window.performance&&window.performance.now?window.performance.now():Date.now()},initConsole:function(){if(!window.console){var s=function(){};window.console={info:s,log:s,warn:s,error:s}}}};var N={};Object.defineProperty(N,"__esModule",{value:!0});var X=256,Bt=function(){function s(){}return s.resize=function(t,e){e===void 0&&(e=1);var i,n;if(t instanceof HTMLImageElement?(i=s.createCanvas(t.width,t.height),n=i.getContext("2d"),n.drawImage(t,0,0)):(i=t,n=i.getContext("2d")),e===1)return i;for(var r=n.getImageData(0,0,t.width,t.height),o=t.width*e,a=t.height*e,h=s.createCanvas(o,a),c=h.getContext("2d"),l=c.getImageData(0,0,o,a),d=0;d<a;d++)for(var S=0;S<o;S++){var T=(Math.floor(d/e)*t.width+Math.floor(S/e))*4,E=(d*o+S)*4;l.data[E]=r.data[T],l.data[E+1]=r.data[T+1],l.data[E+2]=r.data[T+2],l.data[E+3]=r.data[T+3]}return c.putImageData(l,0,0),h},s.createCanvas=function(t,e,i){var n=document.createElement("canvas");if(n.width=t,n.height=e,s.prepCanvas(n),i){var r=typeof i=="string"?document.getElementById(i):i;r.innerHTML="",r.appendChild(n)}return n},s.ensure256Square=function(t){if(t.width<X||t.height<X){var e=Math.max(X,t.width),i=Math.max(X,t.height),n=s.createCanvas(e,i),r=n.getContext("2d");r.drawImage(t,0,0),t=n}return t},s.prepCanvas=function(t){var e=t.getContext("2d");e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.oImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1},s.makeColorTranslucent=function(t,e,i){e===void 0&&(e=0),i===void 0&&(i=0);for(var n=t.getContext("2d"),r=t.width,o=t.height,a=n.getImageData(0,0,r,o),h=[],c=(i*r+e)*4,l=0;l<4;l++)h[l]=a.data[c+l];for(i=0;i<o;i++)for(e=0;e<r;e++){var d=(i*r+e)*4;a.data[d]===h[0]&&a.data[d+1]===h[1]&&a.data[d+2]===h[2]&&a.data[d+3]===h[3]&&(a.data[d]=0,a.data[d+1]=0,a.data[d+2]=0,a.data[d+3]=0)}return n.putImageData(a,0,0),t},s.allowSubpixelImageRendering=!1,s}();N.default=Bt;var K={};Object.defineProperty(K,"__esModule",{value:!0});var H=N,Wt=function(){function s(t,e,i,n,r){e!==void 0&&i!==void 0&&n!==void 0&&r!==void 0?(this.x=e,this.y=i,this.w=n,this.h=r):(this.x=this.y=0,this.w=t.width,this.h=t.height),this.canvas=H.default.ensure256Square(t)}return s.prototype.draw=function(t,e,i){H.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i)),t.drawImage(this.canvas,this.x,this.y,this.w,this.h,e,i,this.w,this.h)},s.prototype.drawScaled=function(t,e,i,n,r){H.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i)),t.drawImage(this.canvas,this.x,this.y,this.w,this.h,e,i,n,r)},s.prototype.drawScaled2=function(t,e,i,n,r,o,a,h,c){H.default.allowSubpixelImageRendering||(e=Math.round(e),i=Math.round(i),o=Math.round(o),a=Math.round(a)),e=this.x+e,i=this.y+i,t.drawImage(this.canvas,e,i,n,r,o,a,h,c)},s.prototype.makeColorTranslucent=function(t,e){t===void 0&&(t=0),e===void 0&&(e=0),H.default.makeColorTranslucent(this.canvas,t,e)},Object.defineProperty(s.prototype,"width",{get:function(){return this.w},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this.h},enumerable:!1,configurable:!0}),s}();K.default=Wt;var z={};Object.defineProperty(z,"__esModule",{value:!0});var Kt=function(){function s(t,e,i){i===void 0&&(i=0),this.id=t,this.buffer=e,this.loopsByDefault=!0,this.loopStart=i}return s.prototype.getBuffer=function(){return this.buffer},s.prototype.getId=function(){return this.id},s.prototype.getLoopsByDefaultIfMusic=function(){return this.loopsByDefault},s.prototype.setLoopsByDefaultIfMusic=function(t){this.loopsByDefault=t},s.prototype.getLoopStart=function(){return this.loopStart},s.prototype.setLoopStart=function(t){this.loopStart=t},s}();z.default=Kt;var tt={};Object.defineProperty(tt,"__esModule",{value:!0});var jt=K,Xt=N,Zt=function(){function s(t,e){this.atlasInfo=e,this.masterCanvas=t,this.atlasInfo.firstPixelIsTranslucent&&(this.masterCanvas=Xt.default.makeColorTranslucent(this.masterCanvas))}return s.prototype.parse=function(t){var e=this;t===void 0&&(t=1);var i={};return this.atlasInfo.images.forEach(function(n){var r=n.id,o,a,h,c;if(n.dim){var l=n.dim.split(/,\s*/);if(l.length!==4)throw new Error("Invalid value for imgInfo ".concat(r,"'s dim: ").concat(n.dim));o=parseInt(l[0],10),a=parseInt(l[1],10),h=parseInt(l[2],10),c=parseInt(l[3],10)}else if(o=typeof n.x=="number"?n.x:-1,a=typeof n.y=="number"?n.y:-1,typeof n.s=="number"?h=c=n.s:(h=typeof n.w=="number"?n.w:-1,c=typeof n.h=="number"?n.h:-1),o<0||a<0||h<0||c<0)throw new Error("x, y, w, h (or s) not specified for imgInfo: ".concat(JSON.stringify(n)));t!==1&&(o*=t,a*=t,h*=t,c*=t),i[r]=new jt.default(e.masterCanvas,o,a,h,c)}),i},s}();tt.default=Zt;Object.defineProperty(J,"__esModule",{value:!0});var $t=W,O=St,A=M,Z=N,Ct=K,Vt=z,qt=tt,Jt=function(){function s(t,e,i){t===void 0&&(t=1),this.scale=t||1,this.loadingAssetData={},this.responses={},this.callback=void 0,this.audio=e,this.assetRoot=i}return s.prototype.addJson=function(t,e){var i=this;if(e===void 0&&(e=t),this.assetRoot&&(e=this.assetRoot+e),!this.isAlreadyTracked(t)){this.loadingAssetData[t]={type:O.AssetType.JSON},console.log("Adding: "+t+" => "+e+", remaining == "+A.default.getObjectSize(this.loadingAssetData)+", callback == "+(this.callback!==null));var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var r=n.responseText;i.completed(t,r)}},n.open("GET",e,!0),n.send(null)}},s.prototype.addCanvas=function(t,e){var i=this;this.assetRoot&&(e=this.assetRoot+e);var n=document.createElement("img");this.isAlreadyTracked(t)||(this.loadingAssetData[t]={type:O.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+A.default.getObjectSize(this.loadingAssetData)+", callback == "+(this.callback!==null)),n.addEventListener("load",function(){var r=Z.default.resize(n,i.scale);i.completed(t,r)}),n.src=e)},s.prototype.addImage=function(t,e,i){var n=this;i===void 0&&(i=!1),this.assetRoot&&(e=this.assetRoot+e);var r=document.createElement("img");this.isAlreadyTracked(t)||(this.loadingAssetData[t]={type:O.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+A.default.getObjectSize(this.loadingAssetData)+", callback == "+(this.callback!==null)),r.addEventListener("load",function(){var o=Z.default.resize(r,n.scale),a=new Ct.default(o);i&&a.makeColorTranslucent(0,0),n.completed(t,a)}),r.src=e)},s.prototype.addImageAtlasContents=function(t,e,i){var n=this;this.assetRoot&&(e=this.assetRoot+e);var r=document.createElement("img");this.isAlreadyTracked(t)||(this.loadingAssetData[t]={type:O.AssetType.IMAGE},console.log("Adding: ".concat(t," => ").concat(e,", remaining == ").concat(A.default.getObjectSize(this.loadingAssetData),", ")+"callback == ".concat(this.callback!==null)),r.addEventListener("load",function(){var o=Z.default.resize(r,n.scale),a=new qt.default(o,i),h=typeof i.prefix=="string"?i.prefix:i.prefix?"".concat(t,"."):"",c=a.parse();for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(n.responses[h+l]=c[l]);n.completed(t,a)}),r.src=e)},s.prototype.addSound=function(t,e,i,n){var r=this;if(i===void 0&&(i=0),n===void 0&&(n=!0),this.audio.isInitialized()){if(this.isAlreadyTracked(t))return;this.loadingAssetData[t]={type:O.AssetType.AUDIO},this.assetRoot&&(e=this.assetRoot+e);var o=new XMLHttpRequest;o.onload=function(){r.audio.context.decodeAudioData(o.response,function(a){var h=new Vt.default(t,a,i||0);h.setLoopsByDefaultIfMusic(n),r.audio.addSound(h),r.completed(t,a)})},o.open("GET",e,!0),o.responseType="arraybuffer",o.send(null)}},s.prototype.addSpriteSheet=function(t,e,i,n,r,o,a){var h=this;r===void 0&&(r=0),o===void 0&&(o=0),a===void 0&&(a=!1),r=r||0,o=o||0,i*=this.scale,n*=this.scale,r*=this.scale,o*=this.scale,this.assetRoot&&(e=this.assetRoot+e);var c=document.createElement("img");this.isAlreadyTracked(t)||(this.loadingAssetData[t]={type:O.AssetType.IMAGE},console.log("Adding: "+t+" => "+e+", remaining == "+A.default.getObjectSize(this.loadingAssetData)+", callback == "+(this.callback!==null)),c.addEventListener("load",function(){var l=Z.default.resize(c,h.scale),d=new Ct.default(l);a&&d.makeColorTranslucent(0,0);var S=new $t.default(d,i,n,r,o);h.completed(t,S)}),c.src=e)},s.prototype.addTmxMap=function(t){var e=this;t.tilesets.forEach(function(i){var n="_tilesetImage_"+i.name;e.addImage(n,i.image)})},s.prototype.getTmxTilesetImage=function(t){return this.responses["_tilesetImage_"+t.name]},s.prototype.get=function(t){var e=this.responses[t];if(!e)throw new Error("Resource is not loaded: ".concat(t));return e},s.prototype.isAlreadyTracked=function(t){return this.loadingAssetData[t]?(console.log("A resource with id ".concat(t," is already loading.  Assuming they are the same")),!0):this.responses[t]?(console.log("A resource with id ".concat(t," has already been loaded.")),!0):!1},s.prototype.set=function(t,e){this.responses[t]=e},s.prototype.completed=function(t,e){if(!this.loadingAssetData[t]){console.error("Resource not found! - ".concat(t));return}this.loadingAssetData[t].type===O.AssetType.JSON&&(e=JSON.parse(e)),this.responses[t]=e,delete this.loadingAssetData[t],console.log("Completed: "+t+", remaining == "+A.default.getObjectSize(this.loadingAssetData)+", callback == "+(this.callback!==null)),this.isDoneLoading()&&this.callback?(this.callback.call(this),delete this.callback,console.log("... Callback called and deleted (callback == "+(this.callback!==null)+")"),this.nextCallback&&(this.callback=this.nextCallback,delete this.nextCallback)):console.log("... Not running callback - "+this.isDoneLoading()+", "+(this.callback!==null))},s.prototype.isDoneLoading=function(){return A.default.getObjectSize(this.loadingAssetData)===0},s.prototype.onLoad=function(t){this.isDoneLoading()?t():this.callback?this.nextCallback=t:this.callback=t},s}();J.default=Jt;var et={};Object.defineProperty(et,"__esModule",{value:!0});var Qt=function(){function s(t){this.config=t,this.id=-1,this.soundId=void 0,this.source=void 0,this.paused=!1,this.startOffset=-1,this.startTime=-1,this.playedTime=0}return s.prototype.initFromConfig=function(){var t=this;this.id=this.config.id,this.soundId=this.config.soundId,this.source=this.config.audioSystem.context.createBufferSource(),this.source.loop=this.config.loop,this.source.buffer=this.config.buffer,this.config.connectTo instanceof Array?this.config.connectTo.forEach(function(e){t.source.connect(e)}):this.source.connect(this.config.connectTo),this.startOffset=this.config.startOffset||0,this.config.loop||(this.source.onended=this.config.onendedGenerator(this.id))},s.prototype.isPaused=function(){return this.paused},s.prototype.pause=function(){this.paused||(this.source.stop(),this.playedTime+=this.source.context.currentTime-this.startTime,this.paused=!0,this.startTime=0)},s.prototype.resume=function(){if(this.paused){this.paused=!1;var t=this.startOffset;this.initFromConfig(),this.startOffset=t+this.playedTime,this.startOffset=this.startOffset%this.source.buffer.duration;var e=this.source.context.currentTime;this.source.start(e,this.startOffset),this.startTime=e,this.playedTime=0}},s.prototype.start=function(){this.paused=!1,this.initFromConfig();var t=this.source.context.currentTime;this.source.start(t,this.startOffset),this.startTime=t,this.playedTime=0},s}(),zt=.3,te=1e3,ee=function(){function s(){this.currentMusic=void 0,this.sounds={},this.musicFade=zt,this.doFadeMusic=!0,this.muted=!1,this.initialized=!1,this.playingSounds=[],this.soundEffectIdGenerator=0}return s.prototype.createPlayingSound=function(t,e,i,n){var r=this;e===void 0&&(e=!1),i===void 0&&(i=0);var o=this.createSoundEffectId();return new Qt({audioSystem:this,buffer:this.sounds[t].getBuffer(),connectTo:this.volumeFaderGain,id:o,loop:e,onendedGenerator:function(a){return function(){r.removePlayingSound(a),n&&n(o,t)}},soundId:t,startOffset:i})},s.prototype.createSoundEffectId=function(){return this.soundEffectIdGenerator++},s.prototype.init=function(){var t=window;try{t.AudioContext=t.AudioContext||t.webkitAudioContext,t.AudioContext?(this.context=new t.AudioContext,this.volumeFaderGain=this.context.createGain(),this.volumeFaderGain.gain.setValueAtTime(1,this.context.currentTime),this.volumeFaderGain.gain.value=1,this.volumeFaderGain.connect(this.context.destination),this.initialized=!0):console.log("The Web Audio API is not supported in this browser.")}catch(e){console.error("The Web Audio API is not supported in this browser."),console.error(e)}return this.initialized},s.prototype.addSound=function(t){this.context&&(this.sounds[t.getId()]=t)},s.prototype.fadeOutMusic=function(t){var e=this;this.context&&(this.currentMusic?(this.muted||(this.musicFaderGain.gain.setValueAtTime(this.musicFaderGain.gain.value,this.context.currentTime),this.musicFaderGain.gain.linearRampToValueAtTime(0,this.context.currentTime+this.musicFade)),setTimeout(function(){e.playMusic(t)},this.musicFade*te)):this.playMusic(t))},s.prototype.getCurrentMusic=function(){return this.currentMusicId},s.prototype.isInitialized=function(){return this.initialized},s.prototype.pauseAll=function(){this.playingSounds.forEach(function(t){t.pause()})},s.prototype.playMusic=function(t,e){if(this.context){if(this.currentMusic&&this.stopMusic(!1),!t)return;var i=this.sounds[t];typeof e>"u"&&(e=i.getLoopsByDefaultIfMusic()),this.musicFaderGain=this.context.createGain(),this.musicFaderGain.gain.setValueAtTime(1,this.context.currentTime),this.musicFaderGain.gain.value=1,this.currentMusic=this.context.createBufferSource(),this.currentMusic.loop=e,this.musicLoopStart=i.getLoopStart()||0,this.currentMusic.loopStart=this.musicLoopStart,this.currentMusic.buffer=i.getBuffer(),this.currentMusic.loopEnd=this.currentMusic.buffer.duration,this.currentMusic.connect(this.musicFaderGain),this.musicFaderGain.connect(this.volumeFaderGain),this.currentMusic.start(0),this.currentMusicId=t,console.log("Just started new music with id: ".concat(t,", loop: ").concat(e))}},s.prototype.playSound=function(t,e,i){if(e===void 0&&(e=!1),this.context){var n=this.createPlayingSound(t,e,0,i);return this.playingSounds.push(n),n.start(),n.id}return-1},s.prototype.removePlayingSound=function(t){for(var e=0;e<this.playingSounds.length;e++)if(this.playingSounds[e].id===t){var i=this.playingSounds[e];return this.playingSounds.splice(e,1),i}return null},s.prototype.resumeAll=function(){for(var t=0;t<this.playingSounds.length;t++){var e=this.playingSounds[t];e.isPaused()&&e.resume()}},s.prototype.stopMusic=function(t){t===void 0&&(t=!1),this.currentMusic&&(this.currentMusic.stop(),t||(this.currentMusic.disconnect(),this.musicFaderGain.disconnect(),delete this.currentMusic,delete this.currentMusicId,delete this.musicFaderGain))},s.prototype.stopSound=function(t){var e=this.removePlayingSound(t);return e&&e.source?(e.source.stop(),!0):!1},s.prototype.toggleMuted=function(){if(this.muted=!this.muted,this.context){var t=this.muted?0:1;this.volumeFaderGain.gain.setValueAtTime(t,this.context.currentTime),this.volumeFaderGain.gain.value=t}return this.muted},Object.defineProperty(s.prototype,"fadeMusic",{get:function(){return this.doFadeMusic},set:function(t){this.doFadeMusic=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"musicFadeSeconds",{get:function(){return this.musicFade},set:function(t){this.musicFade=t},enumerable:!1,configurable:!0}),s}();et.default=ee;var Tt={},ie=V&&V.__extends||function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},s(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(Tt,"__esModule",{value:!0});var se=W,ne=32,re=function(s){ie(t,s);function t(e,i,n,r,o,a){return a===void 0&&(a=1),s.call(this,e,i,n,r,o,a)||this}return t.prototype.drawString=function(e,i,n){for(var r=this.size,o=window,a=o.game.canvas.getContext("2d"),h=this.cellW,c=0;c<e.length;c++){var l=e.charCodeAt(c)-ne;(l<0||l>=r)&&(l=0),this.drawByIndex(a,i,n,l),i+=h}},t}(se.default);Tt.default=re;var _t={};Object.defineProperty(_t,"__esModule",{value:!0});_t.default={resize:function(s,t){switch(t){default:case 0:s.style.width=s.width+"px",s.style.height=s.height+"px";break;case 1:s.style.width=document.body.clientWidth+"px",s.style.height=document.body.clientHeight+"px";break;case 2:var e=document.body.clientWidth/s.width,i=document.body.clientHeight/s.height,n=Math.min(e,i);s.style.width=Math.floor(s.width*n)+"px",s.style.height=Math.floor(s.height*n)+"px";break}}};var Et={};Object.defineProperty(Et,"__esModule",{value:!0});var oe=function(){function s(t){if(!t||!t.millis)throw'Missing required "millis" argument to Delay';this.initial=Array.isArray(t.millis)?t.millis:[t.millis],this.initialIndex=0,t.minDelta&&t.maxDelta&&this.setRandomDelta(t.minDelta,t.maxDelta),this.callback=t.callback,this.loop=!!t.loop,this.loopCount=0,this.maxLoopCount=this.loop&&t.loopCount||-1,this.remaining=0,this.curInitial=0,this.reset()}return s.prototype.update=function(t){return this.remaining>0&&(this.remaining-=t,this.remaining<=0&&this.callback&&this.callback(this)),this.remaining<=0&&(this.loop?this.maxLoopCount===-1||this.loopCount<this.maxLoopCount-1?(this.loopCount++,this.nextInitial(!0)):(this.loopCount=this.maxLoopCount,this.remaining=-1):this.remaining=Math.max(0,this.remaining)),this.isDone()},s.prototype.getLoopCount=function(){return this.loopCount},s.prototype.getMaxDelta=function(){return typeof this.maxDelta<"u"?this.maxDelta:-1},s.prototype.getMinDelta=function(){return typeof this.minDelta<"u"?this.minDelta:-1},s.prototype.getRemaining=function(){return this.remaining},s.prototype.getRemainingPercent=function(){return this.remaining/this.curInitial},s.prototype.isDone=function(){return(!this.loop||this.loopCount===this.maxLoopCount)&&this.remaining<=0},s.prototype.nextInitial=function(t){t===void 0&&(t=!1);var e=this.remaining;this.initialIndex=(this.initialIndex+1)%this.initial.length,this.curInitial=this.remaining=this.initial[this.initialIndex],t&&e<0&&(this.remaining+=e),this.minDelta||this.maxDelta},s.prototype.setRandomDelta=function(t,e){this.minDelta=t,this.maxDelta=e},s.prototype.reset=function(){this.initialIndex=0,this.curInitial=this.remaining=this.initial[this.initialIndex],this.loopCount=0},s.prototype.toString=function(){return"[Delay: _initial=".concat(this.initial,", ")+"_remaining=".concat(this.remaining,", ")+"_loop=".concat(this.loop,", ")+"_callback=".concat(!!this.callback)+"]"},s}();Et.default=oe;var vt={},G={},it={},st={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Keys=void 0,function(t){t[t.KEY_ENTER=13]="KEY_ENTER",t[t.KEY_SHIFT=16]="KEY_SHIFT",t[t.KEY_CTRL=17]="KEY_CTRL",t[t.KEY_SPACE=32]="KEY_SPACE",t[t.KEY_LEFT_ARROW=37]="KEY_LEFT_ARROW",t[t.KEY_UP_ARROW=38]="KEY_UP_ARROW",t[t.KEY_RIGHT_ARROW=39]="KEY_RIGHT_ARROW",t[t.KEY_DOWN_ARROW=40]="KEY_DOWN_ARROW",t[t.KEY_0=48]="KEY_0",t[t.KEY_1=49]="KEY_1",t[t.KEY_2=50]="KEY_2",t[t.KEY_3=51]="KEY_3",t[t.KEY_4=52]="KEY_4",t[t.KEY_5=53]="KEY_5",t[t.KEY_6=54]="KEY_6",t[t.KEY_7=55]="KEY_7",t[t.KEY_8=56]="KEY_8",t[t.KEY_9=57]="KEY_9",t[t.KEY_A=65]="KEY_A",t[t.KEY_B=66]="KEY_B",t[t.KEY_C=67]="KEY_C",t[t.KEY_D=68]="KEY_D",t[t.KEY_E=69]="KEY_E",t[t.KEY_F=70]="KEY_F",t[t.KEY_G=71]="KEY_G",t[t.KEY_H=72]="KEY_H",t[t.KEY_I=73]="KEY_I",t[t.KEY_J=74]="KEY_J",t[t.KEY_K=75]="KEY_K",t[t.KEY_L=76]="KEY_L",t[t.KEY_M=77]="KEY_M",t[t.KEY_N=78]="KEY_N",t[t.KEY_O=79]="KEY_O",t[t.KEY_P=80]="KEY_P",t[t.KEY_Q=81]="KEY_Q",t[t.KEY_R=82]="KEY_R",t[t.KEY_S=83]="KEY_S",t[t.KEY_T=84]="KEY_T",t[t.KEY_U=85]="KEY_U",t[t.KEY_V=86]="KEY_V",t[t.KEY_W=87]="KEY_W",t[t.KEY_X=88]="KEY_X",t[t.KEY_Y=89]="KEY_Y",t[t.KEY_Z=90]="KEY_Z"}(s.Keys||(s.Keys={}))})(st);var nt={};Object.defineProperty(nt,"__esModule",{value:!0});var P=st,ae=function(){function s(t){t===void 0&&(t=0),this.keys=[],this.refireMillis=t,this.repeatTimers=[]}return s.prototype.clearKeyState=function(t){this.keys[t]=!1,this.repeatTimers[t]&&(clearInterval(this.repeatTimers[t]),delete this.repeatTimers[t])},s.prototype.clearKeyStates=function(){for(var t=0;t<this.keys.length;t++)this.clearKeyState(t)},s.prototype.ctrl=function(t){return t===void 0&&(t=!1),this.isKeyDown(P.Keys.KEY_CTRL,t)},s.prototype.down=function(t){return t===void 0&&(t=!1),this.isKeyDown(P.Keys.KEY_DOWN_ARROW,t)},s.prototype.enter=function(t){return t===void 0&&(t=!1),this.isKeyDown(P.Keys.KEY_ENTER,t)},s.prototype.install=function(){var t=this;document.onkeydown=function(e){t._keyDown(e)},document.onkeyup=function(e){t._keyUp(e)}},s.prototype.isKeyDown=function(t,e){e===void 0&&(e=!1);var i=this.keys[t];return i&&e&&(this.keys[t]=!1),i},s.prototype._keyDown=function(t){var e=this,i=t.keyCode;(i===32||i>=37&&i<=40)&&t.preventDefault(),this.refireMillis?this.repeatTimers[i]||(this.keys[i]=!0,this.repeatTimers[i]=+setInterval(function(){e.keys[i]=!0},this.refireMillis)):this.keys[i]=!0,t.stopPropagation()},s.prototype._keyUp=function(t){var e=t.keyCode;this.refireMillis?this.repeatTimers[e]?(this.keys[e]=!1,clearInterval(this.repeatTimers[e]),delete this.repeatTimers[e]):console.error("_keyUp: Timer does not exist for key: ".concat(e,"!")):this.keys[e]=!1,t.stopPropagation()},s.prototype.left=function(t){return t===void 0&&(t=!1),this.isKeyDown(P.Keys.KEY_LEFT_ARROW,t)},s.prototype.right=function(t){return t===void 0&&(t=!1),this.isKeyDown(P.Keys.KEY_RIGHT_ARROW,t)},s.prototype.shift=function(t){return t===void 0&&(t=!1),this.isKeyDown(P.Keys.KEY_SHIFT,t)},s.prototype.up=function(t){return t===void 0&&(t=!1),this.isKeyDown(P.Keys.KEY_UP_ARROW,t)},s}();nt.default=ae;var yt={};Object.defineProperty(yt,"__esModule",{value:!0});var L=M,he=function(){function s(){this.isPaused=!1,this.pauseStart=0,this.isUpdating=!0,this.notUpdatingStart=0,this.startShift=0}return Object.defineProperty(s.prototype,"paused",{get:function(){return this.isPaused},set:function(t){if(this.isPaused!==t)if(this.isPaused=t,t)this.pauseStart=L.default.timestamp();else{var e=L.default.timestamp()-this.pauseStart;this.startShift+=e,this.pauseStart=0}},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"playTime",{get:function(){return this.pauseStart!==0?this.pauseStart-this.startShift:this.notUpdatingStart!==0?this.notUpdatingStart-this.startShift:L.default.timestamp()-this.startShift},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"updating",{get:function(){return this.isUpdating},set:function(t){if(this.isUpdating!==t&&(this.isUpdating=t,!this.paused))if(!this.isUpdating)this.notUpdatingStart=L.default.timestamp();else{var e=L.default.timestamp()-this.notUpdatingStart;this.startShift+=e,this.notUpdatingStart=0}},enumerable:!1,configurable:!0}),s.prototype.resetPlayTime=function(){if(this.paused||!this.updating)throw"Cannot reset playtime millis when paused or not updating";this.startShift=L.default.timestamp()},s.prototype.start=function(){this.startShift=L.default.timestamp()},s}();yt.default=he;var rt={};Object.defineProperty(rt,"__esModule",{value:!0});var Rt=M,ue=function(){function s(){this.startTimes={},this.prefix="DEBUG"}return s.prototype.setLogPrefix=function(t){t===void 0&&(t="DEBUG"),this.prefix=t},s.prototype.start=function(t){this.startTimes[t]=Rt.default.timestamp()},s.prototype.end=function(t){var e=this.startTimes[t];if(!e)return console.error('Cannot end timer for "'+t+'" as it was never started'),-1;var i=Rt.default.timestamp()-e;return delete this.startTimes[t],i},s.prototype.endAndLog=function(t){var e=this.end(t);e>-1&&console.log("".concat(this.prefix,": ").concat(t,": ").concat(e," ms"))},s}();rt.default=ue;Object.defineProperty(it,"__esModule",{value:!0});var Mt=st,ce=nt,le=yt,de=rt,fe=N,$=M,pe=et,ge=J,Nt=100,me=.1,Dt=1e3,Se=30,Te=function(){function s(t){t===void 0&&(t={width:640,height:480}),$.default.initConsole(),this.scale=t.scale||1,this.canvas=fe.default.createCanvas(t.width,t.height,t.parent),this.inputManager=new ce.default(t.keyRefreshMillis||0),this.inputManager.install(),this.targetFps=t.targetFps||Se,this.interval=Dt/this.targetFps,this.lastTime=0,this.audio=new pe.default,this.audio.init();var e=t.assetRoot;this.assets=new ge.default(this.scale,this.audio,e),this.clearScreenColor="rgb(0,0,0)",this.fpsColor="rgb(255,255,255)",this.statusMessageRGB="255,255,255",this.statusMessageColor=null,this.showFps=!1,this.frames=0,this.fpsMsg="".concat(this.targetFps," fps"),this.statusMessage=null,this.statusMessageAlpha=0,this.statusMessageTime=0,this.gameTimer=new le.default,this.timer=new de.default}return s.prototype.clearScreen=function(t){t===void 0&&(t=this.clearScreenColor);var e=this.canvas.getContext("2d");e.fillStyle=t,e.fillRect(0,0,this.getWidth(),this.getHeight())},s.prototype.getHeight=function(){return this.canvas.height},s.prototype.getWidth=function(){return this.canvas.width},Object.defineProperty(s.prototype,"paused",{get:function(){return this.gameTimer.paused},set:function(t){t?this.audio.pauseAll():this.audio.resumeAll(),this.gameTimer.paused=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"playTime",{get:function(){return this.gameTimer.playTime},enumerable:!1,configurable:!0}),s.prototype.randomInt=function(t){var e=0;return t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)},s.prototype.render=function(){var t=this.canvas.getContext("2d");this.state.render(t),this.showFps&&this.renderFps(t),this.statusMessage&&this.statusMessageAlpha>0&&this.renderStatusMessage(t)},s.prototype.renderFps=function(t){this.frames++;var e=$.default.timestamp();e-this.lastTime>=Dt&&(this.fpsMsg="".concat(this.frames," fps"),this.frames=0,this.lastTime=e);var i=10,n=15;t.font="10pt Arial",t.fillStyle=this.fpsColor,t.fillText(this.fpsMsg,i,n)},s.prototype.renderStatusMessage=function(t){if(this.statusMessage){var e=10,i=this.canvas.height-6;t.font="10pt Arial",t.fillStyle=this.statusMessageColor||"#fff",t.fillText(this.statusMessage,e,i)}},s.prototype.resetPlayTime=function(){this.gameTimer.resetPlayTime()},s.prototype.setState=function(t){this.state&&this.state.leaving(this),this.state=t,this.state.enter(this)},s.prototype.setStatusMessage=function(t){this.statusMessage=t,this.statusMessageAlpha=2,this.statusMessageTime=$.default.timestamp()+Nt},s.prototype.start=function(){var t=this.tick.bind(this);this.gameTimer.start(),setInterval(t,this.interval)},s.prototype.tick=function(){if(this.statusMessage){var t=$.default.timestamp();if(t>this.statusMessageTime){this.statusMessageTime=t+Nt,this.statusMessageAlpha-=me;var e=Math.min(1,this.statusMessageAlpha);this.statusMessageColor="rgba(".concat(this.statusMessageRGB,",").concat(e,")"),this.statusMessageAlpha<=0&&(this.statusMessage=null)}}this.update(),this.render()},s.prototype.toggleMuted=function(){var t=this.audio.toggleMuted();return this.setStatusMessage(t?"Audio muted":"Audio enabled"),t},s.prototype.toggleShowFps=function(){this.showFps=!this.showFps,this.setStatusMessage("FPS display: "+(this.showFps?"on":"off"))},s.prototype.update=function(){var t=this.inputManager;t.isKeyDown(Mt.Keys.KEY_SHIFT)&&t.isKeyDown(Mt.Keys.KEY_F,!0)&&this.toggleShowFps(),this.state.update(this.interval)},s}();it.default=Te;Object.defineProperty(G,"__esModule",{value:!0});G.State=void 0;var _e=it,Yt=function(){function s(t){if(t&&t instanceof _e.default)this.game=t;else if(t)this.game=t.game;else{var e=window;this.game=e.game}}return s.prototype.enter=function(t){},s.prototype.leaving=function(t){},s.prototype.update=function(t){},s.prototype.render=function(t){},s}();G.State=Yt;G.default=Yt;var Ee=V&&V.__extends||function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},s(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(vt,"__esModule",{value:!0});var ve=G,ye=800,Ie=function(s){Ee(t,s);function t(e,i,n,r){var o=s.call(this)||this;return o.leavingState=e,o.enteringState=i,o.transitionLogic=n,o.fadingOut=!0,o.alpha=1,o.halfTime=r&&r>0?r/2:ye,o.curTime=0,o}return t.prototype.update=function(e){if(s.prototype.update.call(this,e),this.curTime+=e,this.curTime>=this.halfTime)if(this.curTime-=this.halfTime,this.fadingOut)this.fadingOut=!1,this.transitionLogic&&this.transitionLogic();else{this._setState(this.enteringState);return}this.alpha=this.fadingOut?1-this.curTime/this.halfTime:this.curTime/this.halfTime},t.prototype.render=function(e){s.prototype.render.call(this,e),this.game.clearScreen();var i=e.globalAlpha;e.globalAlpha=this.alpha,this.fadingOut?this.leavingState.render(e):this.enteringState.render(e),e.globalAlpha=i},t.prototype._setState=function(e){this.game.setState(this.enteringState)},t}(ve.default);vt.default=Ie;var It={};Object.defineProperty(It,"__esModule",{value:!0});var we=function(){function s(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=t,this.y=e}return s.prototype.equals=function(t){return!!t&&this.x===t.x&&this.y===t.y},s}();It.default=we;var wt={};Object.defineProperty(wt,"__esModule",{value:!0});var be=function(){function s(t,e,i){e===void 0&&(e=20),i===void 0&&(i=10),this.c=t,this.pool=[];for(var n=0;n<e;n++)this.pool.push(new this.c);this.index=0,this.growCount=i}return s.prototype.borrowObj=function(){var t=this.pool[this.index++];if(this.index>=this.pool.length)for(var e=0;e<this.growCount;e++)this.pool.push(new this.c);return t},Object.defineProperty(s.prototype,"borrowedCount",{get:function(){return this.index},enumerable:!1,configurable:!0}),s.prototype.reset=function(){this.index=0},s.prototype.returnObj=function(t){for(var e=-1,i=0;i<this.index;i++)if(t===this.pool[i]){e=i;break}if(e===-1)return!1;var n=this.pool[--this.index];return this.pool[this.index]=this.pool[e],this.pool[e]=n,!0},Object.defineProperty(s.prototype,"length",{get:function(){return this.pool.length},enumerable:!1,configurable:!0}),s.prototype.toString=function(){return"[Pool: "+"borrowed=".concat(this.borrowedCount,", ")+"size=".concat(this.length)+"]"},s}();wt.default=be;var bt={};Object.defineProperty(bt,"__esModule",{value:!0});var Oe=function(){function s(t,e,i,n){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),n===void 0&&(n=0),this.set(t,e,i,n)}return s.prototype.contains=function(t,e){return t>=this.x&&t<this.x+this.w&&e>=this.y&&e<this.y+this.h},s.prototype.containsRect=function(t,e,i,n){if(e===void 0&&(e=0),i===void 0&&(i=0),n===void 0&&(n=0),typeof t!="number"){var r=t;e=r.y,i=r.w,n=r.h,t=r.x}var o=this.w,a=this.h;if((o|a|i|n)<0)return!1;var h=this.x,c=this.y;if(t<h||e<c)return!1;if(o+=h,i+=t,i<=t){if(o>=h||i>o)return!1}else if(o>=h&&i>o)return!1;if(a+=c,n+=e,n<=e){if(a>=c||n>a)return!1}else if(a>=c&&n>a)return!1;return!0},s.prototype.intersects=function(t){var e=this.w,i=this.h,n=t.w,r=t.h;if(n<=0||r<=0||e<=0||i<=0)return!1;var o=this.x,a=this.y,h=t.x,c=t.y;return n+=h,r+=c,e+=o,i+=a,(n<h||n>o)&&(r<c||r>a)&&(e<o||e>h)&&(i<a||i>c)},s.prototype.set=function(t,e,i,n){typeof t=="number"?(this.x=t,typeof e<"u"&&(this.y=e),typeof i<"u"&&(this.w=i),typeof n<"u"&&(this.h=n)):(this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h)},s}();bt.default=Oe;var Gt={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.StretchMode=void 0,function(t){t[t.STRETCH_NONE=0]="STRETCH_NONE",t[t.STRETCH_FILL=1]="STRETCH_FILL",t[t.STRETCH_PROPORTIONAL=2]="STRETCH_PROPORTIONAL"}(s.StretchMode||(s.StretchMode={}))})(Gt);var ot={},C={};Object.defineProperty(C,"__esModule",{value:!0});C.intersects=C.scaleObject=void 0;function Ae(s,t){s.x*=t,s.y*=t,s.width*=t,s.height*=t}C.scaleObject=Ae;function Pe(s,t,e,i,n){var r=s.width,o=s.height,a=i,h=n;if(a<=0||h<=0||r<=0||o<=0)return!1;var c=s.x,l=s.y,d=t,S=e;return a+=d,h+=S,r+=c,o+=l,(a<d||a>c)&&(h<S||h>l)&&(r<c||r>d)&&(o<l||o>S)}C.intersects=Pe;var R={};Object.defineProperty(R,"__esModule",{value:!0});R.initPropertiesByName=R.getProperty=void 0;function Le(s,t,e){var i=s.propertiesByName.get(t);if(!i){if(typeof e<"u")return e;throw new Error("No such property on object, or named properties not initialized: ".concat(t))}return i.value}R.getProperty=Le;function Ce(s){var t;s.propertiesByName=new Map,(t=s.properties)===null||t===void 0||t.forEach(function(e){s.propertiesByName.set(e.name,e)})}R.initPropertiesByName=Ce;Object.defineProperty(ot,"__esModule",{value:!0});var Re=C,ft=R,Me=function(){function s(t,e){this.chunks=e.chunks,this.compression=e.compression,this.data=e.data,this.draworder=e.draworder,this.encoding=e.encoding,this.height=e.height,this.id=e.id,this.image=e.image,this.layer=e.layer,this.locked=e.locked,this.name=e.name,this.setObjects(e.objects),this.offsetx=e.offsetx,this.offsety=e.offsety,this.opacity=e.opacity,this.parallaxx=e.parallaxx,this.parallaxy=e.parallaxy,this.properties=e.properties,this.repeatx=e.repeatx,this.repeaty=e.repeaty,this.startx=e.startx,this.starty=e.starty,this.tintcolor=e.tintcolor,this.transparentcolor=e.transparentcolor,this.type=e.type,this.visible=e.visible,this.width=e.width,this.x=e.x,this.y=e.y,this.map=t,(0,ft.initPropertiesByName)(this)}return s.prototype.getData=function(t,e){if(!this.data)return-1;var i=this._getIndex(t,e);return this.data[i]},s.prototype.setData=function(t,e,i){if(!this.data)return!1;var n=this._getIndex(t,e);return this.data[n]=i,!0},s.prototype._getIndex=function(t,e){return t*this.width+e},s.prototype.getObjectByName=function(t){return this.objectsByName?this.objectsByName.get(t):void 0},s.prototype.getObjectIntersecting=function(t,e,i,n){var r;return(r=this.objects)===null||r===void 0?void 0:r.find(function(o){return(0,Re.intersects)(o,t,e,i,n)})},s.prototype.getProperty=function(t,e){return(0,ft.getProperty)(this,t,e)},s.prototype.isObjectGroup=function(){return this.type==="objectgroup"},s.prototype.setObjects=function(t){var e=this;t&&(this.objects=[],this.objectsByName=new Map,t.forEach(function(i){(0,ft.initPropertiesByName)(i),e.objects.push(i),e.objectsByName.set(i.name,i)}))},s}();ot.default=Me;var Ot={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.scaleTileset=void 0;function Ne(s,t){s.imagewidth*=t,s.imageheight*=t,s.tilewidth*=t,s.tileheight*=t,s.margin*=t,s.spacing*=t}at.scaleTileset=Ne;Object.defineProperty(Ot,"__esModule",{value:!0});var De=at,xe=ot,xt=R,Ye=C,Ge=function(){function s(t,e){var i=this;this.backgroundcolor=t.backgroundcolor,this.compressionlevel=t.compressionlevel,this.height=t.height,this.hexsidelength=t.hexsidelength,this.infinite=t.infinite,this.layers=t.layers.map(function(r){return new xe.default(i,r)}),this.nextlayerid=t.nextlayerid,this.nextobjectid=t.nextobjectid,this.orientation=t.orientation,this.parallaxoriginx=t.parallaxoriginx,this.parallaxoriginy=t.parallaxoriginy,this.properties=t.properties,this.renderorder=t.renderorder,this.staggeraxis=t.staggeraxis,this.staggerindex=t.staggerindex,this.tiledversion=t.tiledversion,this.tileheight=t.tileheight,this.tilesets=t.tilesets,this.tilewidth=t.tilewidth,this.type=t.type,this.version=t.version,this.width=t.width,this.screenWidth=e.screenWidth,this.screenHeight=e.screenHeight,this.screenRows=Math.ceil(this.screenHeight/this.tileheight),this.screenCols=Math.ceil(this.screenWidth/this.tilewidth);var n=e.imagePathModifier;this.tilesets=t.tilesets.map(function(r){return r.source&&Object.assign(r,e.assets.get(r.source)),n&&(r.image=n(r.image)),r}),this.layersByName=new Map,this.objectGroups=[],this.layers.forEach(function(r){i.layersByName.set(r.name,r),r.isObjectGroup()&&i.objectGroups.push(r)}),(0,xt.initPropertiesByName)(this)}return s.prototype.draw=function(t,e,i,n,r){var o=this;n===void 0&&(n=0),r===void 0&&(r=0);var a=this.width,h=this.height;this.screenRows,this.screenCols;var c=this.tilewidth,l=this.tileheight,d=c,S=this.screenWidth,T=this.screenHeight,E=i*c+n+c/2,k=e*l+r+l/2,I=E-S/2,F=k-T/2,w=Math.floor(I/c);I%d<0&&w--;var ut=w*c,b=Math.floor(F/l);F%d<0&&b--;var ct=b*l,j=ut-I,D=j,lt=ct-F,U=lt;w<0&&(w+=a),b<0&&(b+=h);for(var Pt=b;U<T;)this.layers.forEach(function(x){var Lt=w;if(D=j,x.visible){var dt=1;for(x.opacity<1&&(dt=t.globalAlpha,t.globalAlpha=dt*x.opacity);D<S;){var Ft=x.getData(Pt%h,Lt%a);o.drawTile(t,D,U,Ft,x),D+=c,Lt++}x.opacity<1&&(t.globalAlpha=dt)}}),U+=l,Pt++},s.prototype.drawTile=function(t,e,i,n,r){if(!(n<=0)){var o=this.getTilesetForGid(n);if(!o){console.log("null tileset for: ".concat(n," (layer ").concat(r.name,")"));return}if(n-=o.firstgid,!(n<0)){var a=window,h=a.game,c=h.assets.getTmxTilesetImage(o),l=this.tilewidth,d=l+o.spacing,S=this.tileheight,T=S+o.spacing,E=Math.floor(c.width/d);o.spacing>0&&c.width%d===l&&E++;var k=Math.floor(n/E)*T,I=n%E*d;c.drawScaled2(t,I,k,l,S,e,i,l,S)}}},s.prototype.getLayer=function(t){var e=this.layersByName.get(t);if(!e)throw new Error("No such layer: ".concat(t));return e},s.prototype.getLayerIfExists=function(t){return this.layersByName.get(t)},s.prototype.getLayerByIndex=function(t){return this.layers[t]},s.prototype.getLayerCount=function(){return this.layers.length},s.prototype.getPixelHeight=function(){return this.height*this.tileheight},s.prototype.getPixelWidth=function(){return this.width*this.tilewidth},s.prototype.getProperty=function(t,e){return(0,xt.getProperty)(this,t,e)},s.prototype.getTilesetForGid=function(t){for(var e=this.tilesets.length,i=0;i<e;i++)if(this.tilesets[i].firstgid>t)return this.tilesets[i-1];return this.tilesets[e-1]},s.prototype.removeLayer=function(t){for(var e=0;e<this.layers.length;e++)if(this.layers[e].name===t){this.layers.splice(e,1),this.layersByName.delete(t);for(var i=0;i<this.objectGroups.length;i++)this.objectGroups[i].name===t&&delete this.objectGroups[i];return!0}return!1},s.prototype.setScale=function(t){this.tilewidth*=t,this.tileheight*=t,this.screenRows=Math.ceil(this.screenHeight/this.tileheight),this.screenCols=Math.ceil(this.screenWidth/this.tilewidth),this.layers.forEach(function(e){var i;(i=e.objects)===null||i===void 0||i.forEach(function(n){return(0,Ye.scaleObject)(n,t)})}),this.tilesets.forEach(function(e){return(0,De.scaleTileset)(e,t)})},s}();Ot.default=Ge;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.TiledMap=s.TiledLayer=s.Utils=s.Timer=s.StretchMode=s.State=s.SpriteSheet=s.Sound=s.Rectangle=s.Pool=s.Point=s.Keys=s.InputManager=s.ImageUtils=s.ImageAtlas=s.Image=s.Game=s.FadeOutInState=s.Delay=s.CanvasResizer=s.BrowserUtil=s.BitmapFont=s.AudioSystem=s.AssetType=s.AssetLoader=void 0;var t=J;s.AssetLoader=t.default;var e=St;Object.defineProperty(s,"AssetType",{enumerable:!0,get:function(){return e.AssetType}});var i=et;s.AudioSystem=i.default;var n=Tt;s.BitmapFont=n.default;var r=Q;s.BrowserUtil=r.default;var o=_t;s.CanvasResizer=o.default;var a=Et;s.Delay=a.default;var h=vt;s.FadeOutInState=h.default;var c=it;s.Game=c.default;var l=K;s.Image=l.default;var d=tt;s.ImageAtlas=d.default;var S=N;s.ImageUtils=S.default;var T=nt;s.InputManager=T.default;var E=st;Object.defineProperty(s,"Keys",{enumerable:!0,get:function(){return E.Keys}});var k=It;s.Point=k.default;var I=wt;s.Pool=I.default;var F=bt;s.Rectangle=F.default;var w=z;s.Sound=w.default;var ut=W;s.SpriteSheet=ut.default;var b=G;Object.defineProperty(s,"State",{enumerable:!0,get:function(){return b.State}});var ct=Gt;Object.defineProperty(s,"StretchMode",{enumerable:!0,get:function(){return ct.StretchMode}});var j=rt;s.Timer=j.default;var D=M;s.Utils=D.default;var lt=ot;s.TiledLayer=lt.default;var U=Ot;s.TiledMap=U.default})(f);const m={CHASING_GHOSTS:"chasingGhosts",CHOMP_1:"chomp1",CHOMP_2:"chomp2",DIES:"dies",EATING_FRUIT:"eatingFruit",EATING_GHOST:"eatingGhost",EXTRA_LIFE:"extraLife",INTERMISSION:"intermission",EYES_RUNNING:"eyesRunning",OPENING:"opening",SIREN:"siren",TOKEN:"token"};var u=(s=>(s[s.EAST=0]="EAST",s[s.SOUTH=1]="SOUTH",s[s.WEST=2]="WEST",s[s.NORTH=3]="NORTH",s))(u||{});class pt{constructor(t=0,e=0){this.row=t,this.col=e}equals(t){return this.row===t.row&&this.col===t.col}set(t,e,i){this.row=t,this.col=e,this.parent=i}toString(){return"[MazeNode: ("+this.row+","+this.col+")]"}}const q=class q{};q.SPRITE_SIZE=16,q.TILE_SIZE=8;let p=q;const ke=[50,10];class g{constructor(t){this.closed=[],this.open=[],this.goalNode=new pt,this.data=[],this.reset(t)}static _cloneObjectOfPrimitives(t){return JSON.parse(JSON.stringify(t))}checkForDot(t,e){let i=0;const n=this.getTileAt(t,e);return n>=254&&(game.playChompSound(),n===254&&game.makeGhostsBlue(),this.eatenDotCount++,this.data[t][e]=0,i=ke[n-254],this.eatenDotCount===g.FRUIT_DOT_COUNT&&game.addFruit(),this.eatenDotCount===this.dotCount&&game.loadNextLevel()),i}static _constructPath(t){let e=null;for(;t.parent;)e=t,t=t.parent;return e}static get FRUIT_DOT_COUNT(){return 64}static _getNextColumn(t){return++t===g.TILE_COUNT_HORIZONTAL&&(t=0),t}getPathBreadthFirst(t,e,i,n){this.open.forEach(o=>{this.data[o.row][o.col]&=255}),this.closed.forEach(o=>{this.data[o.row][o.col]&=255}),this.open.length=0,this.closed.length=0,this.goalNode.set(i,n,null);let r=this.nodeCache.borrowObj();for(this.open.push(new pt(t,e)),this.data[t][e]|=256;this.open.length>0;){const o=this.open.splice(0,1)[0];if(o.equals(this.goalNode))return this.data[o.row][o.col]&=255,g._constructPath(o);{this.closed.push(o),this.isWalkable(o.row-1,o.col)&&(this.data[o.row-1][o.col]&256||(this.data[o.row-1][o.col]|=256,r.set(o.row-1,o.col,o),this.open.push(r),r=this.nodeCache.borrowObj())),this.isWalkable(o.row+1,o.col)&&(this.data[o.row+1][o.col]&256||(this.data[o.row+1][o.col]|=256,r.set(o.row+1,o.col,o),this.open.push(r),r=this.nodeCache.borrowObj()));let a=g._getPreviousColumn(o.col);this.isWalkable(o.row,a)&&(this.data[o.row][a]&256||(this.data[o.row][a]|=256,r.set(o.row,a,o),this.open.push(r),r=this.nodeCache.borrowObj())),a=g._getNextColumn(o.col),this.isWalkable(o.row,a)&&(this.data[o.row][a]&256||(this.data[o.row][a]|=256,r.set(o.row,a,o),this.open.push(r),r=this.nodeCache.borrowObj()))}}throw new Error("No path found from ("+t+", "+e+") to ("+i+", "+n+")")}static _getPreviousColumn(t){return t===0&&(t=g.TILE_COUNT_HORIZONTAL),t-1}static get TILE_COUNT_HORIZONTAL(){return 28}static get TILE_COUNT_VERTICAL(){return 32}static get TILE_DOT_BIG(){return 254}static get TILE_DOT_SMALL(){return 255}getTileAt(t,e){return e<0||e>=g.TILE_COUNT_HORIZONTAL||t<0||t>=g.TILE_COUNT_VERTICAL?-1:this.data[t][e]&255}isClearShotColumn(t,e,i){const n=Math.min(e,i),r=Math.max(e,i);for(let o=n+1;o<r;o++)if(!this.isWalkable(o,t))return!1;return!0}isClearShotRow(t,e,i){const n=Math.min(e,i),r=Math.max(e,i);for(let o=n+1;o<r;o++)if(!this.isWalkable(t,o))return!1;return!0}isWalkable(t,e){const i=this.getTileAt(t,e);return i===0||i>=240}render(t){t.drawImage(this.mazeCanvas,0,0);const e=8;t.fillStyle="#ffffff";for(let i=0;i<g.TILE_COUNT_VERTICAL;i++){const n=i*e+2*e;for(let r=0;r<g.TILE_COUNT_HORIZONTAL;r++){const o=this.getTileAt(i,r),a=r*e;o===g.TILE_DOT_SMALL?game.drawSmallDot(a+3,n+2):o===g.TILE_DOT_BIG&&game.drawBigDot(a,n)}}}reset(t){const e=p.TILE_SIZE,i=t!=null;if(i&&(this.origMazeInfo=g._cloneObjectOfPrimitives(t)),this.data=g._cloneObjectOfPrimitives(this.origMazeInfo),this.eatenDotCount=0,i){const n=game.assets.get("mapTiles"),r=2*e;this.mazeCanvas=f.ImageUtils.createCanvas(game.getWidth(),game.getHeight());const o=this.mazeCanvas.getContext("2d");let a=0;this.dotCount=0,o.fillStyle="#000000",o.fillRect(0,0,this.mazeCanvas.width,this.mazeCanvas.height),game.drawScoresHeaders(o);for(let h=0;h<this.data.length;h++){const c=this.data[h];for(let l=0;l<c.length;l++){let d=c[l];switch((d===0||d>=240)&&a++,d){case g.TILE_DOT_SMALL:case g.TILE_DOT_BIG:this.dotCount++;break;default:if(d--,d>-1){const S=l*e,T=r+h*e;n.drawByIndex(o,S,T,d)}break}}}this.nodeCache||(this.nodeCache=new f.Pool(pt,a))}}}class At{constructor(t){this.bounds=new f.Rectangle(0,0,p.SPRITE_SIZE,p.SPRITE_SIZE),this._intersectBounds=new f.Rectangle,this.direction=u.EAST,this._frame=0,this._frameCount=t,this._lastUpdateTime=0}atIntersection(t){switch(this.direction){case u.NORTH:case u.SOUTH:return this.getCanMoveLeft(t)||this.getCanMoveRight(t);case u.EAST:case u.WEST:return this.getCanMoveUp(t)||this.getCanMoveDown(t)}}getCanMoveDown(t){const e=this.centerX,i=this.centerY,n=e%this.TILE_SIZE,r=i%this.TILE_SIZE;if(n===0&&r===0){const o=this.row,a=this.column;return o<30&&t.isWalkable(o+1,a)}return this.direction===u.NORTH||this.direction===u.SOUTH}getCanMoveLeft(t){let e=this.bounds.x;if(e<0)return!0;e+=this.TILE_SIZE/2;const i=this.centerY,n=e%this.TILE_SIZE,r=i%this.TILE_SIZE;if(n===0&&r===0){const o=this.row,a=this.column;return a>0&&t.isWalkable(o,a-1)}return this.direction===u.EAST||this.direction===u.WEST}getCanMoveRight(t){let e=this.bounds.x;if(e+this.width>this.SCREEN_WIDTH)return!0;e+=this.TILE_SIZE/2;const i=this.centerY,n=e%this.TILE_SIZE,r=i%this.TILE_SIZE;if(n===0&&r===0){const o=this.row,a=this.column;return a<27&&t.isWalkable(o,a+1)}return this.direction===u.EAST||this.direction===u.WEST}getCanMoveUp(t){const e=this.centerX,i=this.centerY;(e%1!==0||i%1!==0)&&console.error("Unexpected condition: x === "+e+", y === "+i);const n=e%this.TILE_SIZE,r=i%this.TILE_SIZE;if(n===0&&r===0){const o=this.row,a=this.column;return o>0&&t.isWalkable(o-1,a)}return this.direction===u.NORTH||this.direction===u.SOUTH}get centerX(){return this.bounds.x+this.TILE_SIZE/2}get centerY(){return this.bounds.y+this.TILE_SIZE/2}get column(){let t=Math.floor(this.centerX/this.TILE_SIZE);return t<0?t+=g.TILE_COUNT_HORIZONTAL:t>=g.TILE_COUNT_HORIZONTAL&&(t-=g.TILE_COUNT_HORIZONTAL),t}getFrame(){return this._frame}getFrameCount(){return this._frameCount}get intersectBounds(){return this._intersectBounds.set(this.bounds.x+2,this.bounds.y-2,this.bounds.w-4,this.bounds.h-4),this._intersectBounds}get moveAmount(){return 1}get TILE_SIZE(){return 8}get width(){return this.bounds.w}get row(){return Math.floor(this.centerY/this.TILE_SIZE)}get x(){return this.bounds.x}get y(){return this.bounds.y}goDownIfPossible(t,e){return this.getCanMoveDown(t)?(this.direction=u.SOUTH,this.incY(e),!0):!1}goLeftIfPossible(t,e){return this.getCanMoveLeft(t)?(this.direction=u.WEST,this.incX(-e),!0):!1}goRightIfPossible(t,e){return this.getCanMoveRight(t)?(this.direction=u.EAST,this.incX(e),!0):!1}goUpIfPossible(t,e){return this.getCanMoveUp(t)?(this.direction=u.NORTH,this.incY(-e),!0):!1}incX(t){this.bounds.x+=t,this.bounds.x+this.width<=0?this.bounds.x+=this.SCREEN_WIDTH:this.bounds.x>=this.SCREEN_WIDTH&&(this.bounds.x-=this.SCREEN_WIDTH)}incY(t){this.bounds.y+=t}intersects(t){return this.intersectBounds.intersects(t.intersectBounds)}reset(){this._lastUpdateTime=0}get SCREEN_WIDTH(){return 224}setLocation(t,e){this.bounds.x=t,this.bounds.y=e}updateFrame(){this._frame=(this._frame+1)%this.getFrameCount()}updatePosition(t,e){e>this._lastUpdateTime+this.getUpdateDelayMillis()&&(this._lastUpdateTime=e,this.updatePositionImpl(t))}set x(t){this.bounds.x=t}set y(t){this.bounds.y=t}}class Fe extends At{constructor(){super(3),this._dyingFrame=0}getUpdateDelayMillis(){return 10}handleInput(t){const e=game.inputManager;e.left()?this.getCanMoveLeft(t)&&(this.direction=u.WEST):e.right()&&this.getCanMoveRight(t)&&(this.direction=u.EAST),e.up()?this.getCanMoveUp(t)&&(this.direction=u.NORTH):e.down()&&this.getCanMoveDown(t)&&(this.direction=u.SOUTH)}incDying(){return this._dyingFrame=(this._dyingFrame+1)%12,this._dyingFrame!==0}render(t){const e=p.SPRITE_SIZE,i=this.bounds.x,n=this.bounds.y;let r,o;this._dyingFrame>0?(r=e*this._dyingFrame,o=96):(r=this.direction*e*this.getFrameCount()+this.getFrame()*e,o=80),game.drawSprite(i,n,r,o)}reset(){super.reset(),this.direction=u.WEST,this.setLocation(13*8,24*8-8/2),this._frame=0}setLocation(t,e){super.setLocation(t,e)}startDying(){this._dyingFrame=1}updatePositionImpl(t){const e=this.moveAmount;switch(this.direction){case u.WEST:this.goLeftIfPossible(t,e);break;case u.EAST:this.goRightIfPossible(t,e);break;case u.NORTH:this.goUpIfPossible(t,e);break;case u.SOUTH:this.goDownIfPossible(t,e);break}game.increaseScore(t.checkForDot(this.row,this.column))}}const y=class y extends At{constructor(){super(1),this.setLocation(game.PENALTY_BOX_EXIT_X,140);let t=game.level;t>7&&(t=game.randomInt(8)),this._col=y.COLS[t],this._row=y.ROWS[t],this._pointsIndex=y.PTS_INDEX[t]}get pointsIndex(){return this._pointsIndex}getUpdateDelayMillis(){return 1e11}paint(t){const e=p.SPRITE_SIZE,i=this._col*e,n=this._row*e;game.drawSprite(this.x,this.y,i,n)}updatePositionImpl(t){}};y.COLS=[12,13,12,13,13,12,13,13],y.ROWS=[4,4,5,5,2,6,6,3],y.PTS_INDEX=[0,2,4,5,10,7,9,11];let mt=y;const gt=.5;var _=(s=>(s[s.IN_BOX=0]="IN_BOX",s[s.LEAVING_BOX=1]="LEAVING_BOX",s[s.CHASING_PACMAN=2]="CHASING_PACMAN",s[s.SCATTERING=3]="SCATTERING",s[s.BLUE=4]="BLUE",s[s.EYES=5]="EYES",s[s.EYES_ENTERING_BOX=6]="EYES_ENTERING_BOX",s))(_||{});class ht extends At{constructor(t,e,i){super(2),this.game=t,this.corner=new f.Point,this.spriteSheetY=e,this.exitDelaySeconds=i,this.reset()}changeDirectionFallback(t){const e=this.moveAmount;switch(f.Utils.randomInt(4)){case 0:this.goUpIfPossible(t,e)||this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||this.goDownIfPossible(t,e);break;case 1:this.goLeftIfPossible(t,e)||this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||this.goRightIfPossible(t,e);break;case 2:this.goDownIfPossible(t,e)||this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||this.goUpIfPossible(t,e);break;case 3:this.goRightIfPossible(t,e)||this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||this.goLeftIfPossible(t,e);break}}continueInCurrentDirection(t){switch(this.direction){case u.NORTH:this.incY(-t);break;case u.WEST:this.incX(-t);break;case u.SOUTH:this.incY(t);break;case u.EAST:this.incX(t);break}}getBlueTimeForLevel(t){switch(t){case 0:case 1:return 8e3;case 2:case 3:return 6e3;case 4:case 5:return 4e3;case 6:case 7:return 2e3;default:return 0}}getFirstExitDelayMillis(){return this.exitDelaySeconds*1e3}getFrameCount(){return 2}get motionState(){return this._motionState}getUpdateDelayMillis(){switch(this._motionState){case 4:return 25;case 5:case 6:return 10;default:return 10}}isBlue(){return this._motionState===4}isEyes(){return this._motionState===5||this._motionState===6}paint(t){const e=this.bounds.x,i=this.bounds.y,n=p.SPRITE_SIZE;let r,o;switch(this._motionState){case 4:r=(10+this.getFrame())*n,o=3*n;const a=game.playTime;this.exitBlueTime-a<=1e3&&a/250&1&&(o+=n),game.drawSprite(e,i,r,o);break;case 5:case 6:r=this.direction*n,o=4*n,game.drawSprite(e,i,r,o);break;default:r=this.direction*n*this.getFrameCount()+this.getFrame()*n,o=this.spriteSheetY,game.drawSprite(e,i,r,o);break}}possiblyTurnBlue(){switch(this._motionState){case 2:case 3:case 4:return this._motionState=4,!0;default:return!1}}reset(){super.reset(),this.scatterCount=0}setCorner(t){this.corner.x=t.x,this.corner.y=t.y}set motionState(t){const e=this.game;if(t===3)switch(this.scatterCount++){case 0:case 1:this.exitScatteringTime=e.playTime+7e3,this._motionState=t;break;case 2:case 3:this.exitScatteringTime=e.playTime+5e3,this._motionState=t;break;default:this._motionState=2;break}else if(t===4){const i=this.getBlueTimeForLevel(e.level),n=e.playTime;switch(this.exitBlueTime=n+i,this._motionState){case 2:this.previousState=this._motionState,this.startScatteringTime+=i;break;case 3:this.previousState=this._motionState,this.exitScatteringTime+=i;break;case 4:const r=this.exitBlueTime-n;switch(this.previousState){case 2:this.startScatteringTime+=r+i;break;case 3:this.exitScatteringTime+=r+i;break}break;default:throw new Error("Unexpected state: "+this._motionState)}this._motionState=t}else this._motionState===2&&(this.startScatteringTime=e.playTime+2e4),this._motionState=t;this.game.checkLoopedSound()}updatePositionBlue(t){const e=this.moveAmount;if(this.atIntersection(t)){const i=game.pacman,n=i.row,r=i.column,o=this.row,a=this.column;let h=!1;o===n&&t.isClearShotRow(o,a,r)?(this.goUpIfPossible(t,e)||this.goDownIfPossible(t,e)||(r<a?this.goRightIfPossible(t,e)||(this.direction=u.WEST,this.incX(-e)):this.goLeftIfPossible(t,e)||(this.direction=u.EAST,this.incX(e))),h=!0):a===r&&t.isClearShotColumn(a,o,n)&&(this.goLeftIfPossible(t,e)||this.goRightIfPossible(t,e)||(n<o?this.goDownIfPossible(t,e)||(this.direction=u.NORTH,this.incY(-e)):this.goUpIfPossible(t,e)||(this.direction=u.SOUTH,this.incY(e))),h=!0),h||this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.exitBlueTime&&(this._motionState=this.previousState)}updatePositionEyes(t){const e=this.moveAmount;if(this.atIntersection(t)){const i=this.row,n=this.column,r=Math.floor((game.PENALTY_BOX_EXIT_Y+8)/p.TILE_SIZE);let o=Math.floor(game.PENALTY_BOX_EXIT_X/p.TILE_SIZE);n<=o&&o++;const a=t.getPathBreadthFirst(i,n,r,o);a==null?this._motionState=6:a.col<n?(this.direction=u.WEST,this.incX(-e)):a.col>n?(this.direction=u.EAST,this.incX(e)):a.row<i?(this.direction=u.NORTH,this.incY(-e)):a.row>i&&(this.direction=u.SOUTH,this.incY(e))}else{const i=this.row,n=Math.floor((game.PENALTY_BOX_EXIT_Y+8)/p.TILE_SIZE);i===n&&this.x===game.PENALTY_BOX_EXIT_X?this._motionState=6:this.continueInCurrentDirection(e)}}updatePositionEyesEnteringBox(t){const e=gt;this.y<game.PENALTY_BOX_EXIT_Y+3*p.SPRITE_SIZE/2?(this.direction=u.SOUTH,this.incY(e)):this._motionState=1}updatePositionImpl(t){switch(this._motionState){case 0:this.updatePositionInBox(t);break;case 1:this.updatePositionLeavingBox(t);break;case 3:this.updatePositionScattering(t);break;case 2:this.updatePositionChasingPacman(t);break;case 4:this.updatePositionBlue(t);break;case 5:this.updatePositionEyes(t);break;case 6:this.updatePositionEyesEnteringBox(t);break}}updatePositionInBox(t){const e=gt;switch(this.direction){case u.WEST:case u.NORTH:this.y>112?this.incY(-e):this.direction=u.SOUTH;break;case u.EAST:case u.SOUTH:this.y<120?this.incY(e):this.direction=u.NORTH;break}game.playTime>=this.getFirstExitDelayMillis()&&(this._motionState=1)}updatePositionLeavingBox(t){const e=gt,i=this.x;if(i<game.PENALTY_BOX_EXIT_X)this.direction=u.EAST,this.incX(e);else if(i>game.PENALTY_BOX_EXIT_X)this.direction=u.WEST,this.incX(-e);else{let n=this.y-e;this.y=n,n<=game.PENALTY_BOX_EXIT_Y?(n=game.PENALTY_BOX_EXIT_Y,this._motionState=3,this.direction=u.WEST):this.direction=u.NORTH}}updatePositionScattering(t){const e=this.moveAmount;if(this.atIntersection(t)){const i=this.row,n=this.column,r=this.corner.x,o=this.corner.y,a=t.getPathBreadthFirst(i,n,r,o);a?a.col<n?(this.direction=u.WEST,this.incX(-e)):a.col>n?(this.direction=u.EAST,this.incX(e)):a.row<i?(this.direction=u.NORTH,this.incY(-e)):a.row>i&&(this.direction=u.SOUTH,this.incY(e)):this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.exitScatteringTime&&(this._motionState=2)}}class Ue extends ht{constructor(t){super(t,0*p.SPRITE_SIZE,0)}reset(){super.reset(),this.direction=u.WEST,this.setLocation(this.game.PENALTY_BOX_EXIT_X,this.game.PENALTY_BOX_EXIT_Y),this.motionState=_.SCATTERING}updatePositionChasingPacman(t){const e=this.moveAmount;if(this.atIntersection(t)){const i=this.row,n=this.column,r=this.game.pacman.row,o=this.game.pacman.column,a=t.getPathBreadthFirst(i,n,r,o);a==null?this.changeDirectionFallback(t):a.col<n?(this.direction=u.WEST,this.incX(-e)):a.col>n?(this.direction=u.EAST,this.incX(e)):a.row<i?(this.direction=u.NORTH,this.incY(-e)):a.row>i&&(this.direction=u.SOUTH,this.incY(e))}else this.continueInCurrentDirection(e);this.game.playTime>=this.startScatteringTime&&(this.motionState=_.SCATTERING)}}class He extends ht{constructor(t){super(t,2*p.SPRITE_SIZE,2)}reset(){super.reset(),this.direction=u.NORTH,this.setLocation(14*p.TILE_SIZE-p.TILE_SIZE/2-4,15*p.TILE_SIZE-p.TILE_SIZE/2),this.motionState=_.IN_BOX}updatePositionChasingPacman(t){const e=this.moveAmount,i=game.pacman,n=i.row,r=i.column,o=this.row,a=this.column;let h=!1;this.atIntersection(t)?(o===n&&t.isClearShotRow(o,a,r)?(r<a?(this.direction=u.WEST,this.incX(-e)):this.goRightIfPossible(t,e)||this.changeDirectionFallback(t),h=!0):a===r&&t.isClearShotColumn(a,o,n)&&(n<o?(this.direction=u.NORTH,this.incY(-e)):this.goDownIfPossible(t,e)||this.changeDirectionFallback(t),h=!0),h||this.changeDirectionFallback(t)):this.continueInCurrentDirection(e),game.playTime>=this.startScatteringTime&&(this.motionState=_.SCATTERING)}}class Be extends ht{constructor(t){super(t,1*p.SPRITE_SIZE,8)}reset(){super.reset(),this.direction=u.SOUTH,this.setLocation(12*p.TILE_SIZE-p.TILE_SIZE/2-4,15*p.TILE_SIZE-p.TILE_SIZE/2),this.motionState=_.IN_BOX}updatePositionChasingPacman(t){const e=this.moveAmount;if(this.atIntersection(t)){const i=this.row,n=this.column,r=game.getGhost(0),o=r.row,a=r.column;if((a-n)*(a-n)+(o-i)*(o-i)<=35){const c=game.pacman.row,l=game.pacman.column,d=t.getPathBreadthFirst(i,n,c,l);d==null?this.changeDirectionFallback(t):d.col<n?(this.direction=u.WEST,this.incX(-e)):d.col>n?(this.direction=u.EAST,this.incX(e)):d.row<i?(this.direction=u.NORTH,this.incY(-e)):d.row>i&&(this.direction=u.SOUTH,this.incY(e))}else this.changeDirectionFallback(t)}else this.continueInCurrentDirection(e);game.playTime>=this.startScatteringTime&&(this.motionState=_.SCATTERING)}}class We extends ht{constructor(t){super(t,3*p.SPRITE_SIZE,14)}reset(){super.reset(),this.direction=u.SOUTH,this.setLocation(16*p.TILE_SIZE-p.TILE_SIZE/2-4,15*p.TILE_SIZE-p.TILE_SIZE/2),this.motionState=_.IN_BOX}updatePositionChasingPacman(t){const e=this.moveAmount;this.atIntersection(t)?this.changeDirectionFallback(t):this.continueInCurrentDirection(e),game.playTime>=this.startScatteringTime&&(this.motionState=_.SCATTERING)}}class Y extends f.State{constructor(t){super(t),this._lastConfigKeypressTime=f.Utils.timestamp(),this._lastSpriteFrameTime=0}static get INPUT_REPEAT_MILLIS(){return 200}handleDefaultKeys(){const t=f.Utils.timestamp(),e=this.game.inputManager;if(t>this._lastConfigKeypressTime+Y.INPUT_REPEAT_MILLIS&&(e.isKeyDown(f.Keys.KEY_M,!0)&&(game.toggleMuted(),this._lastConfigKeypressTime=t),e.isKeyDown(f.Keys.KEY_Z)))if(e.isKeyDown(f.Keys.KEY_P,!0)){const i=game.canvas.style;i.width||(i.width=game.canvas.width+"px"),i.height||(i.height=game.canvas.height+"px"),i.width=parseInt(i.width.substring(0,i.width.length-2),10)+1+"px",i.height=parseInt(i.height.substring(0,i.height.length-2),10)+1+"px",game.setStatusMessage(`Canvas size now: (${i.width}, ${i.height})`),this._lastConfigKeypressTime=t}else if(e.isKeyDown(f.Keys.KEY_L,!0)){const i=game.canvas.style;i.width||(i.width=game.canvas.width+"px"),i.height||(i.height=game.canvas.height+"px"),i.width=parseInt(i.width.substring(0,i.width.length-2),10)-1+"px",i.height=parseInt(i.height.substring(0,i.height.length-2),10)-1+"px",game.setStatusMessage(`Canvas size now: (${i.width}, ${i.height})`),this._lastConfigKeypressTime=t}else e.isKeyDown(f.Keys.KEY_G,!0)?(game.toggleGodMode(),this._lastConfigKeypressTime=t):e.isKeyDown(f.Keys.KEY_S,!0)&&game.toggleStretchMode()}_updateSpriteFrames(){const t=game.playTime;t>=this._lastSpriteFrameTime+100&&(this._lastSpriteFrameTime=t,game.updateSpriteFrames())}}class kt extends Y{constructor(t){super(t),this._initSprites(),this.handleStart=this.handleStart.bind(this)}enter(){super.enter(game),game.canvas.addEventListener("touchstart",this.handleStart,{capture:!1,passive:!0}),this.choice=0,this.lastKeypressTime=game.playTime,this._initSprites()}_initSprites(){const t=game.pacman;t.setLocation(game.getWidth()/2,240),t.direction=u.EAST;const e=game.getGhost(0);e.setLocation(game.getWidth()/2-3*p.SPRITE_SIZE,240),e.direction=u.EAST}leaving(t){t.canvas.removeEventListener("touchstart",this.handleStart,!1)}handleStart(){this.startGame()}render(t){const e=game.getWidth(),i=game.getHeight(),n=9;this.renderStaticStuff(t);let r=(e-n*15)/2-5,o=(i-15*2)/2;this.game.drawString(r,o+this.choice*15,">"),r+=n*1.5,o=200,game.canvas.getContext("2d").fillStyle="#ffffff",game.drawSmallDot(r+3,o+2),o+=9,game.drawBigDot(r,o),game.pacman.render(t),game.getGhost(0).paint(t),game.audio.isInitialized()||this.renderNoSoundMessage()}stringWidth(t){return game.assets.get("font").cellW*t.length}renderNoSoundMessage(){const t=game.getWidth();let e="SOUND IS DISABLED AS",i=(t-this.stringWidth(e))/2,n=game.getHeight()-20-9*3;this.game.drawString(i,n,e),e="YOUR BROWSER DOES NOT",i=(t-this.stringWidth(e))/2,n+=9,this.game.drawString(i,n,e),e="SUPPORT WEB AUDIO",i=(t-this.stringWidth(e))/2,n+=9,this.game.drawString(i,n,e)}renderStaticStuff(t){const e=this.game;e.clearScreen("rgb(0,0,0)");const i=e.getWidth(),n=9;e.drawScores(t),e.drawScoresHeaders(t);const r=e.assets.get("title");let o=(i-r.width)/2,a=r.height*1.2;r.draw(t,o,a);let h="STANDARD MAZE",c=h.length-1;o=(i-n*c)/2-5,a=(e.getHeight()-15*2)/2,this.game.drawString(o,a,h,t),h="ALTERNATE MAZE",a+=15,this.game.drawString(o,a,h,t),o+=n*2,h="10 POINTS",c=h.length-2,a=200,this.game.drawString(o,a,h,t),h="50 POINTS",a+=9,this.game.drawString(o,a,h,t),h="2015 OLD MAN GAMES",o=(i-n*h.length)/2,a=e.getHeight()-20,this.game.drawString(o,a,h,t)}startGame(){game.startGame(this.choice)}update(t){this.handleDefaultKeys();const e=game.playTime;if(e>this.lastKeypressTime+Y.INPUT_REPEAT_MILLIS+100){const o=game.inputManager;o.up()?(this.choice=Math.abs(this.choice-1),game.audio.playSound(m.TOKEN),this.lastKeypressTime=e):o.down()?(this.choice=(this.choice+1)%2,game.audio.playSound(m.TOKEN),this.lastKeypressTime=e):o.enter(!0)&&this.startGame()}const i=game.pacman,n=game.getGhost(0);let r=i.moveAmount;i.direction===u.WEST&&(r=-r),i.incX(r),r=n.moveAmount,n.direction===u.WEST&&(r=-r),n.incX(r),i.x+i.width>=this.game.getWidth()-30?i.direction=n.direction=u.WEST:n.x<=30&&(i.direction=n.direction=u.EAST),this._updateSpriteFrames()}}class v extends Y{constructor(t){super(),this._mazeFile=t}static get DYING_FRAME_DELAY_MILLIS(){return 75}get readyDelayMillis(){return this.firstTimeThrough?4500:2e3}enter(){game.pacman.reset(),game.resetGhosts(),this.maze=new g(this._mazeFile),this.firstTimeThrough=!0,this.updateScoreIndex=-1,this.lastMazeScreenKeypressTime=game.playTime+v.INPUT_REPEAT_MILLIS,this.substate="READY",this.firstTimeThrough=!0,this.substateStartTime=0,this.nextDyingFrameTime=0,this.nextUpdateTime=0,this._lastSpriteFrameTime=0}paintExtraLives(t){const n=game.lives;if(n>0){let r=24;const o=game.getHeight()-2*8,a=2*8;for(let h=0;h<n;h++)game.drawSprite(r,o,12*16,3*16),r+=a}}paintPossibleFruits(t){const i=p.TILE_SIZE,n=game.getWidth()-12-2*i,r=game.getHeight()-2*i;switch(game.level){default:case 7:game.drawSprite(n-112,r,13*16,3*16);case 6:game.drawSprite(n-96,r,13*16,6*16);case 5:game.drawSprite(n-80,r,12*16,6*16);case 4:game.drawSprite(n-64,r,13*16,2*16);case 3:game.drawSprite(n-48,r,13*16,5*16);case 2:game.drawSprite(n-32,r,12*16,5*16);case 1:game.drawSprite(n-16,r,13*16,4*16);case 0:game.drawSprite(n,r,12*16,4*16);break}}render(t){super.render(t),this.maze.render(t);const e=8,i=game.getHeight()-2*e-g.TILE_COUNT_VERTICAL*e;t.translate(0,i),game.drawFruit(t);const n=game.pacman;if(this.updateScoreIndex===-1)this.substate!=="GAME_OVER"&&n.render(t);else{const r=n.bounds.x,o=n.bounds.y;game.paintPointsEarned(t,this.updateScoreIndex,r,o)}if(game.drawGhosts(t),t.translate(0,-i),game.drawScores(t),this.paintExtraLives(t),this.paintPossibleFruits(t),this.substate==="READY"){const r="READY!";let o=(game.getWidth()-r.length*9)/2;o+=3,game.drawString(o,160,r)}else if(this.substate==="GAME_OVER"){const r="GAME OVER",o=(game.getWidth()-r.length*9)/2;game.drawString(o,160,r)}if(game.paused){t.globalAlpha=.4,t.fillStyle="black",t.fillRect(0,0,game.getWidth(),game.getHeight()),t.globalAlpha=1,t.fillRect(50,100,game.getWidth()-100,game.getHeight()-200);const r="PAUSED",o=(game.getWidth()-r.length*9)/2;game.drawString(o,(game.getHeight()-18)/2,r)}}reset(){this.maze.reset(),game.resetPlayTime(),game.pacman.reset(),game.resetGhosts(),this.substate="READY",this.substateStartTime=0,this._lastSpriteFrameTime=0,this.lastMazeScreenKeypressTime=game.playTime+v.INPUT_REPEAT_MILLIS}handleInput(t,e){this.handleDefaultKeys();const i=game.inputManager;if(this.substate!=="GAME_OVER"&&i.enter(!0)){game.paused=!game.paused,this.lastMazeScreenKeypressTime=e;return}if(!game.paused)switch(this.substate){case"IN_GAME":game.pacman.handleInput(this.maze);break;case"GAME_OVER":i.enter(!0)&&game.setState(new kt(game));break}e>=this.lastMazeScreenKeypressTime+v.INPUT_REPEAT_MILLIS&&!game.paused&&this.substate==="IN_GAME"&&i.isKeyDown(f.Keys.KEY_Z)&&(i.isKeyDown(f.Keys.KEY_X)?(game.loadNextLevel(),this.lastMazeScreenKeypressTime=e):i.isKeyDown(f.Keys.KEY_C)&&this.substate!=="DYING"&&(game.startPacmanDying(),this.substate="DYING",this.nextDyingFrameTime=e+v.DYING_FRAME_DELAY_MILLIS,this.lastMazeScreenKeypressTime=e))}update(t){super.update(t),this.handleInput(t,game.playTime);const e=game.playTime;switch(this.substate){case"READY":this.firstTimeThrough&&this.substateStartTime===0&&(this.substateStartTime=e,game.audio.playSound(m.OPENING)),e>=this.substateStartTime+this.readyDelayMillis&&(this.substate="IN_GAME",this.substateStartTime=e,game.resetPlayTime(),this.lastMazeScreenKeypressTime=game.playTime,game.setLoopedSound(m.SIREN),this.firstTimeThrough=!1);break;case"IN_GAME":this.updateInGameImpl(e);break;case"DYING":e>=this.nextDyingFrameTime&&(game.pacman.incDying()?this.nextDyingFrameTime=e+v.DYING_FRAME_DELAY_MILLIS:game.increaseLives(-1)<=0?this.substate="GAME_OVER":(game.resetPlayTime(),this.lastMazeScreenKeypressTime=game.playTime,game.pacman.reset(),game.resetGhosts(),this.substate="READY",this.substateStartTime=0,this._lastSpriteFrameTime=0));break}}updateInGameImpl(t){if(this.nextUpdateTime>0&&t<this.nextUpdateTime)return;this.nextUpdateTime=0,this.updateScoreIndex=-1,this._updateSpriteFrames(),game.updateSpritePositions(this.maze,t);const e=game.checkForCollisions();if(e)switch(e.motionState){case _.BLUE:this.nextUpdateTime=t+B.SCORE_DISPLAY_LENGTH,e.motionState=_.EYES,this.updateScoreIndex=game.ghostEaten(e);break;case _.EYES:case _.EYES_ENTERING_BOX:break;default:game.godMode||(game.startPacmanDying(),this.substate="DYING",this.nextDyingFrameTime=game.playTime+v.DYING_FRAME_DELAY_MILLIS);break}}}const Ke=5e4;class B extends f.Game{constructor(t){super(t),this.stretchMode=f.StretchMode.STRETCH_PROPORTIONAL,this.highScore=Ke,this.pacman=new Fe,this.ghosts=this._createGhostArray(),this.chompSound=0,this._ghostUpdateStrategy=0,this.score=0,this.desktopGame=t.desktopGame?t.desktopGame:this._isRunningInElectron(),this.extraPointsArray=[100,200,300,400,500,700,800,1e3,1600,2e3,3e3,5e3],this._possiblyRegisterDesktopModeListeners()}addFruit(){this.fruit||(this.fruit=new mt,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1)}checkForCollisions(){for(let t=0;t<this.ghosts.length;t++)if(this.pacman.intersects(this.ghosts[t]))return this.ghosts[t];return this.fruit&&this.fruitScoreIndex===-1&&this.pacman.intersects(this.fruit)&&(this.increaseScore(this.extraPointsArray[this.fruit.pointsIndex]),this.audio.playSound(m.EATING_FRUIT,!1),this.fruitScoreIndex=this.fruit.pointsIndex,this.fruitScoreEndTime=this.playTime+B.SCORE_DISPLAY_LENGTH),null}checkLoopedSound(){if(this.resettingGhostStates)return;let t=!1;for(let e=0;e<this.ghosts.length;e++)if(this.ghosts[e].isEyes()){this.setLoopedSound(m.EYES_RUNNING);return}else this.ghosts[e].isBlue()&&(t=!0);this.setLoopedSound(t?m.CHASING_GHOSTS:m.SIREN)}_createGhostArray(){const t=[];return this.resettingGhostStates=!0,t.push(new Ue(this)),t.push(new He(this)),t.push(new Be(this)),t.push(new We(this)),this.resettingGhostStates=!1,t}drawBigDot(t,e){const i=this.playTime;if(i<0||i%500>250){const n=this.canvas.getContext("2d");this.assets.get("sprites").drawScaled2(n,135,38,8,8,t,e,8,8)}}drawFruit(t){this.fruit&&this.fruitScoreIndex>-1?(this.paintPointsEarned(t,this.fruitScoreIndex,this.fruit.x,this.fruit.y),this.playTime>=this.fruitScoreEndTime&&(this.fruit=null,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1)):this.fruit&&this.fruit.paint(t)}drawGhosts(t){this.ghosts.forEach(e=>{e.paint(t)})}drawScores(t){let e=this.score.toString(),i=55-e.length*8;const n=10;this.drawString(i,n,e,t),e=this.highScore.toString(),i=132-e.length*8,this.drawString(i,n,e,t)}drawScoresHeaders(t){this.drawString(16,0,"1UP",t),this.drawString(67,0,"HIGH SCORE",t)}drawSmallDot(t,e){this.canvas.getContext("2d").fillRect(t,e,2,2)}drawSprite(t,e,i,n){const r=this.assets.get("sprites"),o=this.canvas.getContext("2d");r.drawScaled2(o,i,n,16,16,t,e,16,16)}drawString(t,e,i,n=this.canvas.getContext("2d")){const r=i.toString(),o=this.assets.get("font"),a=65,h=48;let c;for(let l=0;l<r.length;l++){const d=r[l],S=r.charCodeAt(l);if(d>="A"&&d<="Z")c=o.colCount+(S-a);else if(d>="0"&&d<="9")c=S-h;else switch(d){case"-":c=10;break;case".":c=11;break;case">":c=12;break;case"@":c=13;break;case"!":c=14;break;default:c=15;break}o.drawByIndex(n,t,e,c),t+=9}}getGhost(t){return this.ghosts[t]}get godMode(){return this._godMode}static get EXTRA_LIFE_SCORE(){return 1e4}get level(){return this._level}get lives(){return this._lives}get PENALTY_BOX_EXIT_X(){return(this.getWidth()-p.SPRITE_SIZE)/2}get PENALTY_BOX_EXIT_Y(){return 12*p.TILE_SIZE-p.TILE_SIZE/2}static get SCORE_DISPLAY_LENGTH(){return 750}ghostEaten(t){switch(this.eatenGhostPointsIndex){case 0:this.eatenGhostPointsIndex=1;break;case 1:this.eatenGhostPointsIndex=3;break;case 3:this.eatenGhostPointsIndex=6;break;default:case 6:this.eatenGhostPointsIndex=8;break}return this.increaseScore(this.extraPointsArray[this.eatenGhostPointsIndex]),this.audio.playSound(m.EATING_GHOST),this.eatenGhostPointsIndex}increaseLives(t){return this._lives+=t}increaseScore(t){this.score+=t,this.score>this.highScore&&(this.highScore=this.score),!this.earnedExtraLife&&this.score>=B.EXTRA_LIFE_SCORE&&(this.audio.playSound(m.EXTRA_LIFE),this.increaseLives(1),this.earnedExtraLife=!0)}isDesktopGame(){return this.desktopGame}_isRunningInElectron(){const t=window;return t&&t.process&&t.process.type}loadNextLevel(){this.setLoopedSound(null),this._level++,this.fruit=null,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1,this.state.reset()}makeGhostsBlue(){this.eatenGhostPointsIndex=0,this.ghosts.forEach(t=>{t.possiblyTurnBlue()}),this.checkLoopedSound()}paintPointsEarned(t,e,i,n){this.assets.get("points").drawByIndex(t,i,n,e)}playChompSound(){this.audio.playSound(this.chompSound===0?m.CHOMP_1:m.CHOMP_2),this.chompSound=(this.chompSound+1)%2}_possiblyRegisterDesktopModeListeners(){this.isDesktopGame()&&window.addEventListener("resize",()=>{f.CanvasResizer.resize(this.canvas,this.stretchMode)})}resetGhosts(){this.resettingGhostStates=!0;const t=[new f.Point(2,1),new f.Point(2,g.TILE_COUNT_HORIZONTAL-2),new f.Point(g.TILE_COUNT_VERTICAL-2,1),new f.Point(g.TILE_COUNT_VERTICAL-2,g.TILE_COUNT_HORIZONTAL-2)],e=f.Utils.randomInt(4);for(let i=0;i<this.ghosts.length;i++)this.ghosts[i].reset(),this.ghosts[i].setCorner(t[(e+i)%4]);this.resettingGhostStates=!1}setLoopedSound(t){t!==this.loopedSoundName&&(this.loopedSoundId!=null&&this.audio.stopSound(this.loopedSoundId),this.loopedSoundName=t,this.loopedSoundId=t!=null?this.audio.playSound(t,!0):null)}set ghostUpdateStrategy(t){this._ghostUpdateStrategy=t}startGame(t){this._lives=3,this.score=0,this._level=0;const i=this.assets.get("levels")[t],n=new v(i);this.setState(n)}startPacmanDying(){this.setLoopedSound(null),this.audio.playSound(m.DIES),this.pacman.startDying(),this.fruit=null,this.fruitScoreIndex=-1,this.fruitScoreEndTime=-1}toggleGodMode(){return this._godMode=!this._godMode,this.setStatusMessage("God mode "+(this._godMode?"enabled":"disabled")),this._godMode}toggleStretchMode(){if(this.isDesktopGame()){switch(this.stretchMode){default:case f.StretchMode.STRETCH_NONE:this.stretchMode=f.StretchMode.STRETCH_FILL;break;case f.StretchMode.STRETCH_FILL:this.stretchMode=f.StretchMode.STRETCH_PROPORTIONAL;break;case f.StretchMode.STRETCH_PROPORTIONAL:this.stretchMode=f.StretchMode.STRETCH_NONE;break}this.setStatusMessage("Stretch mode: "+this.stretchMode),f.CanvasResizer.resize(this.canvas,this.stretchMode)}}updateSpriteFrames(){this.pacman.updateFrame(),this.ghosts.forEach(t=>{t.updateFrame()})}updateSpritePositions(t,e){switch(this._ghostUpdateStrategy){case 0:this.ghosts.forEach(i=>{i.updatePosition(t,e)});break;case 1:break;case 2:this.ghosts[0].updatePosition(t,e);break}this.pacman.updatePosition(t,e)}}const je=s=>parseInt(s,16),Xe=s=>{s.forEach(t=>{for(let e=0;e<t.length;e++)t[e]=t[e].map(je)})};class Ze extends Y{constructor(t){super(t),this.assetsLoaded=!1}update(t){if(this.handleDefaultKeys(),!this.assetsLoaded){this.assetsLoaded=!0;const e=this.game;e.assets.addImage("loading","res/loadingMessage.png"),e.assets.onLoad(()=>{e.assets.addImage("title","res/title.png"),e.assets.addSpriteSheet("font","res/font.png",9,7,0,0),e.assets.addImage("sprites","res/sprite_tiles.png",!0),e.assets.addSpriteSheet("mapTiles","res/map_tiles.png",8,8,0,0),e.assets.addSpriteSheet("points","res/points.png",18,9,0,0),e.assets.addJson("levels","res/levelData.json"),e.assets.addSound(m.CHASING_GHOSTS,"res/sounds/chasing_ghosts.wav"),e.assets.addSound(m.CHOMP_1,"res/sounds/chomp_1.wav"),e.assets.addSound(m.CHOMP_2,"res/sounds/chomp_2.wav"),e.assets.addSound(m.DIES,"res/sounds/dies.wav"),e.assets.addSound(m.EATING_FRUIT,"res/sounds/eating_fruit.wav"),e.assets.addSound(m.EATING_GHOST,"res/sounds/eating_ghost.wav"),e.assets.addSound(m.EXTRA_LIFE,"res/sounds/extra_life.wav"),e.assets.addSound(m.EYES_RUNNING,"res/sounds/eyes_running.wav"),e.assets.addSound(m.INTERMISSION,"res/sounds/intermission.wav"),e.assets.addSound(m.OPENING,"res/sounds/opening.wav"),e.assets.addSound(m.SIREN,"res/sounds/siren.wav"),e.assets.addSound(m.TOKEN,"res/sounds/token.wav"),e.assets.onLoad(()=>{Xe(e.assets.get("levels")),f.Utils.getRequestParam("skipTitle")!==null?this.game.startGame(0):e.setState(new f.FadeOutInState(this,new kt))})})}}}const $e=224,Ve=288;window.init=function(s,t){const e=window;e.game=new B({parent:s,width:$e,height:Ve,assetRoot:t,keyRefreshMillis:300,targetFps:60}),e.game.setState(new Ze),e.game.start()};window.init("parent");
